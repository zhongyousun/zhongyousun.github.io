<!DOCTYPE html>
<html class="no-js" lang="zh-tw">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	
	<meta property="fb:app_id" content="725315935966817" />
	<title>.NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-2 - Sun 記事</title>
	<script>(function (d, e) { d[e] = d[e].replace("no-js", "js"); })(document.documentElement, "className");</script>
	<meta name="description"
		content="">
	<meta property="og:title" content=".NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-2" />
<meta property="og:description" content="使用.NET 6 Web API 建立 WebSocket 通訊，本篇紀錄模擬將使用者對應至連線ID並儲存與發送訊息功能的測試過程。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://sunnote.xyz/zh-tw/tutorials/aspnetcore-6.0-signalr-websocket-2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-16T11:05:34+08:00" />
<meta property="article:modified_time" content="2023-06-29T21:46:20+08:00" />

<meta property="og:image" content="http://sunnote.xyz/img/thumbnail/034.webp" />
		  	
	<meta itemprop="name" content=".NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-2">
<meta itemprop="description" content="使用.NET 6 Web API 建立 WebSocket 通訊，本篇紀錄模擬將使用者對應至連線ID並儲存與發送訊息功能的測試過程。"><meta itemprop="datePublished" content="2023-06-16T11:05:34+08:00" />
<meta itemprop="dateModified" content="2023-06-29T21:46:20+08:00" />
<meta itemprop="wordCount" content="722">
<meta itemprop="keywords" content="Web,Csharp,JavaScript," />
	<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=".NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-2"/>
<meta name="twitter:description" content="使用.NET 6 Web API 建立 WebSocket 通訊，本篇紀錄模擬將使用者對應至連線ID並儲存與發送訊息功能的測試過程。"/>

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
	<style>
		
		@media screen and (max-width: 850px) {
		.floating-menu {
			display: none;
			}
		}
		.floating-menu {
		  position: fixed;
		  top: 80%;
		  right: 10px;
		  transform: translateY(-50%);
		}
  
		.main-button {
		  border: none;
		  border-radius: 5px;
		  background-color: #ACD6FF;
		  color: #fff;
		  font-size: 14px;
		  cursor: pointer;
		  height: 38px;
		  width: 38px;
		}
  
		.main-button:hover {
		  background-color: #9accff;
		  color: #333;
		}
  
		.sub-buttons {
		  display: none;
		  position: absolute;
		  top: calc(100% - 170px);
		  right: 0;
		  background-color: var(--wrapperBG);
		  border: 1px solid #ddd;
		  border-radius: 5px;
		  box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.3);
		  width: 100%;
		  transition: background-color 1.3s ease, color 0.3s ease;
		}
		.sub-button {
		  display: block;
		  width: 100%;
		  padding: 10px;
		  border: none;
		  background-color: transparent;
		  color: var(--text-color);
		  font-size: 14px;
		  cursor: pointer;
		}
  
		.sub-button:hover {
		  background-color:var(--wrapperBG2);
		  color: #ACD6FF;
		}
	  </style>
	  
	  
	  <style>
		@import 'https://fonts.googleapis.com/css?family=Montserrat:400,700';
.aa-input-container {
  display: inline-block;
  width: 90%;
  left: 15%;
  top: 10%;
  position: fixed;
  justify-content: center;
  align-items: center;
  z-index: 999;
  display: none;
}
.aa-input-container span,.aa-input-container input {
    width: inherit;
}
.aa-input-search {
  width: 300px;
  padding: 12px 28px 12px 12px;
  border: 2px solid #e4e4e4;
  border-radius: 4px;
  -webkit-transition: .2s;
  transition: .2s;
  font-family: "Montserrat", sans-serif;
  box-shadow: 4px 4px 0 rgba(241, 241, 241, 0.35);
  font-size: 11px;
  box-sizing: border-box;
  color: #333;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
.aa-input-search::-webkit-search-decoration, .aa-input-search::-webkit-search-cancel-button, .aa-input-search::-webkit-search-results-button, .aa-input-search::-webkit-search-results-decoration {
    display: none;
}
.aa-input-search:focus {
    outline: 0;
    border-color: #3a96cf;
    box-shadow: 4px 4px 0 rgba(58, 150, 207, 0.1);
}
.aa-input-icon {
  height: 16px;
  width: 16px;
  position: absolute;
  top: 25px;
  right: 330px;
  -webkit-transform: translateY(-50%);
          transform: translateY(-50%);
  fill: #e4e4e4;
}
.aa-hint {
  color: #e4e4e4;
}
.aa-dropdown-menu {
  background-color: #fff;
  border: 2px solid rgba(228, 228, 228, 0.6);
  border-top-width: 1px;
  font-family: "Montserrat", sans-serif;
  width: 300px;
  margin-top: 10px;
  box-shadow: 4px 4px 0 rgba(241, 241, 241, 0.35);
  font-size: 11px;
  border-radius: 4px;
  box-sizing: border-box;
}
.aa-suggestion {
  padding: 12px;
  border-top: 1px solid rgba(228, 228, 228, 0.6);
  cursor: pointer;
  -webkit-transition: .2s;
  transition: .2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: justify;
      -ms-flex-pack: justify;
          justify-content: space-between;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;

}
.aa-suggestion:hover, .aa-suggestion.aa-cursor {
    background-color: rgba(241, 241, 241, 0.35);
}
.aa-suggestion > span:first-child {
    color: #333;
}
.aa-suggestion > span:last-child {
    text-transform: uppercase;
    color: #a9a9a9;
}
.aa-suggestion > span:first-child em, .aa-suggestion > span:last-child em {
  font-weight: 700;
  font-style: normal;
  background-color: rgba(58, 150, 207, 0.1);
  padding: 2px 0 2px 2px;
}

 
.aa-suggestion {
  display: flex;
  align-items: center;
  padding: 8px;
}

.aa-suggestion img {
  max-width: 64px;
  max-height: 64px;
  margin-right: 16px;
}

.aa-suggestion .aa-suggestion-title {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 4px;
}

.aa-suggestion .aa-suggestion-summary {
  font-size: 14px;
  color: #666;
}

	  </style>
	  <style>
		#back-to-top {
			right: 10px;
  			border-radius: 5px;
  			height: 38px;
		  	width: 38px;
			border: none;
			top: 85%;
			box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.3);
		}

	  </style>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300&display=swap" >

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
	
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MWPM4C5TJS"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-MWPM4C5TJS', { 'anonymize_ip': false });
}
</script>


	
</head>





<div id="modalSearch" class="modal fade" role="dialog" >
	<div class="modal-dialog">
	  <div class="modal-content">
		<div class="modal-header">
		  
		</div>
		<div class="modal-body">
		  <div class="aa-input-container" id="aa-input-container">
    <input type="search" id="aa-search-input" class="aa-input-search" placeholder="Search for titles or URIs..."
      name="search" autocomplete="off" />
    <svg class="aa-input-icon" viewBox="654 -372 1664 1664">
      <path
        d="M1806,332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2,1481.3-116,1358-116s-228.8,43.8-316.5,131.5  C953.8,103.2,910,208.7,910,332s43.8,228.8,131.5,316.5C1129.2,736.2,1234.7,780,1358,780s228.8-43.8,316.5-131.5  C1762.2,560.8,1806,455.3,1806,332z M2318,1164c0,34.7-12.7,64.7-38,90s-55.3,38-90,38c-36,0-66-12.7-90-38l-343-342  c-119.3,82.7-252.3,124-399,124c-95.3,0-186.5-18.5-273.5-55.5s-162-87-225-150s-113-138-150-225S654,427.3,654,332  s18.5-186.5,55.5-273.5s87-162,150-225s138-113,225-150S1262.7-372,1358-372s186.5,18.5,273.5,55.5s162,87,225,150s113,138,150,225  S2062,236.7,2062,332c0,146.7-41.3,279.7-124,399l343,343C2305.7,1098.7,2318,1128.7,2318,1164z" />
    </svg>
  </div>
  <script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/algoliasearch.min.js"></script>
  <script src="https://res.cloudinary.com/jimmysong/raw/upload/rootsongjc-hugo/autocomplete.min.js"></script>
  <script>
    var client = algoliasearch("6CA8UYGMKF","0b6aa5d5a7d49848cea785697d9a99ba");
    var index = client.initIndex('sunnote');
    autocomplete('#aa-search-input',
      { hint: false }, {
      source: autocomplete.sources.hits(index, { hitsPerPage: 20 }),
      displayKey: 'name',
      templates: {
          suggestion: function (suggestion) {
              return '<div class="suggestion">' +
      '<div class="suggestion-image">' +
      '<img src="' + suggestion.cover + '" alt="' + suggestion.title + '" />' +
      '</div>' +
      '<div class="suggestion-content">' +
      '<h4><a href="' + suggestion.url + '">' + suggestion.title + '</a></h4>' +
      '<br>' +
      '<small>' + '<a href="' + suggestion.url + '">'+suggestion.summary+ '</a>' + '</small>' +
      '</div>' +
      '</div>';
        }
      }
    });
  
    $('#searchGlyph').click(function() {
      setTimeout(function(){
        $('#aa-search-input').focus();
      },300);
    });
  </script>
		</div>
	  </div>
	</div>
  </div>


<span class="sun-btn"><i class="fa-solid fa-toggle-on"></i></span>
<span class="moon-btn"><i class="fa-solid fa-toggle-off"></i></span>

<script>
	
let darkModeState = false;

const sun = document.querySelector('.sun-btn');
const moon = document.querySelector('.moon-btn');


const useDark = window.matchMedia("(prefers-color-scheme: dark)");


function toggleDarkMode(state) {
  document.documentElement.classList.toggle("dark-mode", state);
  darkModeState = state;
}


function setDarkModeLocalStorage(state) {
  localStorage.setItem("dark-mode", state);
}


toggleDarkMode(localStorage.getItem("dark-mode") == "true");



  useDark.addEventListener('change', (evt) => {
    toggleDarkMode(evt.matches);
  });



sun.addEventListener("click", () => {
  darkModeState = !darkModeState;

  toggleDarkMode(darkModeState);
  setDarkModeLocalStorage(darkModeState);
});
moon.addEventListener("click", () => {
  darkModeState = !darkModeState;

  toggleDarkMode(darkModeState);
  setDarkModeLocalStorage(darkModeState);
});
</script>

<body class="body">
	
	<script>
		window.fbAsyncInit = function () {
			FB.init({
				appId: '725315935966817',
				xfbml: true,
				version: 'v16.0'
			});
			FB.AppEvents.logPageView();
		};

		(function (d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id)) { return; }
			js = d.createElement(s); js.id = id;
			js.src = "https://connect.facebook.net/en_US/sdk.js";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>


	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/zh-tw" title="Sun Notes" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Sun Notes</div>
					<div class="logo__tagline">Program , Life , Investment , Travel , Insights</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
  <button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
    <span class="menu__btn-title" tabindex="-1">☰選單</span>
  </button>
  <ul class="menu__list">
    <li class="menu__item">
      <a class="menu__link" href="/zh-tw/about">
        <i class='fas fa-house'></i>
          <span class="menu__text">關於</span>
        
      </a>
    </li>
    <li class="menu__item">
      <a class="menu__link" href="/zh-tw/search">
        <i class='fas fa-magnifying-glass'></i>
          <span class="menu__text">站內查詢</span>
        
      </a>
    </li>
    <li class="menu__item">
      <a class="menu__link" href="/zh-tw/archives">
        <i class='fas fa-box-archive'></i>
          <span class="menu__text">文章歸檔</span>
        
      </a>
    </li>
    <li class="menu__item menu__dropdown">
      
        <a class="menu__link">
        <i class='fas fa-plane'></i>
        <span class="menu__text">生活</span>
        <label class="drop-icon" for="生活">▾</label>
        
      </a>
      <input type="checkbox" id="生活">
      <ul class="submenu__list">
        
          <li class="menu__item">
          <a class="menu__link" href="/zh-tw/tags/%E8%8F%B2%E5%BE%8B%E8%B3%93/">
            
            <span class="menu__text">菲律賓</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/zh-tw/tags/%E5%AE%BF%E9%9C%A7/">
            
            <span class="menu__text">宿霧</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/zh-tw/tags/%E5%8F%B0%E7%81%A3/">
            
            <span class="menu__text">台灣</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/zh-tw/tags/%E6%97%A5%E6%9C%AC/">
            
            <span class="menu__text">日本</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/zh-tw/tags/%E5%8C%97%E6%B5%B7%E9%81%93/">
            
            <span class="menu__text">北海道</span>
            
          </a>
          </li>
        
      </ul>
    </li>
    <li class="menu__item menu__dropdown">
      
        <a class="menu__link">
        <i class='fas fa-globe'></i>
        <span class="menu__text"> </span>
        <label class="drop-icon" for=" ">▾</label>
        
      </a>
      <input type="checkbox" id=" ">
      <ul class="submenu__list">
        
          <li class="menu__item">
          <a class="menu__link" href="/">
            
            <span class="menu__text">EN</span>
            
          </a>
          </li>
        
          <li class="menu__item">
          <a class="menu__link" href="/zh-tw">
            
            <span class="menu__text">Zh</span>
            
          </a>
          </li>
        
      </ul>
    </li>
  </ul>
</nav>

	</div>
</header>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-MWPM4C5TJS', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






		<div class="wrapper flex">
			<div class="primary">
				







<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"></link>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"></link>
<style>
	.owl-theme .item {
	  height: 15rem;
	   
	  background-color: var(--wrapperBG);
	  padding: 0.5rem;
	  box-shadow: 0 0 20px 0 var(--shadow); 
	  transform:scale(0.9,0.9);
	  transition: all 0.3s ease-out;
	  border-radius: 3%;
	  transition: background-color 1.3s ease, color 0.3s ease, margin-top 0.4s ease;
	}
	.owl-theme .item:hover {
		margin-top: -10px;
		 
	}
	
	.owl-carousel .item h6 {
	  color: #000000;
	  font-weight: 400;
	  font-size: 1rem;
	  margin-top: 0rem;

	  position: relative;
	display: -webkit-box;
	-webkit-box-orient: vertical;
	-webkit-line-clamp: 5;  
	text-overflow: ellipsis;
	overflow: hidden;
	}
	.owl-carousel .item img {
	  width: 100%;
	  height: 7.5rem;
	  border-radius: 4px;
	}
</style>

<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">.NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-2</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="meta__icon icon icon-calendar"  width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(29.019608%,29.019608%,29.019608%);fill-opacity:1;" d="M 2 5.332031 L 2 12.667969 C 2 13.035156 2.296875 13.332031 2.664062 13.332031 L 13.335938 13.332031 C 13.703125 13.332031 14 13.035156 14 12.667969 L 14 5.332031 C 14 4.964844 13.703125 4.667969 13.335938 4.667969 L 2.664062 4.667969 C 2.296875 4.667969 2 4.964844 2 5.332031 Z M 0.667969 5.332031 C 0.667969 4.230469 1.558594 3.332031 2.664062 3.332031 L 13.335938 3.332031 C 14.441406 3.332031 15.332031 4.230469 15.332031 5.332031 L 15.332031 12.667969 C 15.332031 13.769531 14.441406 14.667969 13.335938 14.667969 L 2.664062 14.667969 C 1.558594 14.667969 0.667969 13.769531 0.667969 12.667969 Z M 2 7.332031 L 2 6 L 14 6 L 14 7.332031 Z M 4 2 C 4 1.632812 4.296875 1.332031 4.667969 1.332031 C 5.035156 1.332031 5.332031 1.628906 5.332031 2 L 5.332031 3.332031 L 4 3.332031 Z M 10.667969 2 C 10.667969 1.632812 10.960938 1.332031 11.332031 1.332031 C 11.703125 1.332031 12 1.628906 12 2 L 12 3.332031 L 10.667969 3.332031 Z M 10.667969 2 "/>
</g>
</svg>
<time class="meta__text" datetime="2023-06-16T11:05:34&#43;08:00">June 16, 2023</time>
	<time class="meta__text" datetime="2023-06-29T21:46:20&#43;08:00">(更新日期: June 29, 2023)</time></div>
<div class="meta__item-categories meta__item">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="meta__icon icon icon-folders"  width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(29.019608%,29.019608%,29.019608%);fill-opacity:1;" d="M 2 6 L 2 12.664062 C 2 13.03125 2.296875 13.332031 2.664062 13.332031 L 13.335938 13.332031 C 13.703125 13.332031 14 13.035156 14 12.667969 L 14 8 C 14 7.632812 13.703125 7.332031 13.335938 7.332031 L 9.808594 7.332031 L 8.03125 5.332031 L 2.667969 5.332031 C 2.300781 5.332031 2 5.632812 2 6 Z M 13.335938 6 C 14.4375 6 15.332031 6.894531 15.332031 8 L 15.332031 12.667969 C 15.332031 13.769531 14.441406 14.667969 13.335938 14.667969 L 2.664062 14.667969 C 1.558594 14.667969 0.667969 13.761719 0.667969 12.664062 L 0.667969 6 C 0.667969 4.894531 1.5625 4 2.667969 4 L 8.632812 4 L 10.40625 6 Z M 4.425781 3.625 C 4.425781 3.625 4.425781 3.703125 4.425781 4.074219 C 4.425781 4.328125 5.15625 4.75 6 4.667969 C 6.777344 4.589844 8.453125 4.589844 8.796875 5.050781 C 10 6.667969 14.242188 7.15625 14.242188 6.667969 L 14.242188 5.25 C 14.242188 4.949219 14 4.707031 13.699219 4.707031 L 10.8125 4.707031 L 9.359375 3.082031 L 4.972656 3.082031 C 4.667969 3.082031 4.425781 3.328125 4.425781 3.625 Z M 13.699219 3.625 C 14.601562 3.625 15.332031 4.351562 15.332031 5.25 L 15.332031 8 C 15.332031 8.304688 14.667969 6.667969 10 6.667969 C 8.652344 6.160156 9.402344 5.636719 8 5.25 C 6.496094 4.832031 4.703125 5.296875 3.863281 5.285156 C 3.320312 5.273438 3.332031 4.855469 3.332031 4.667969 L 3.332031 3.625 C 3.332031 2.726562 4.066406 2 4.972656 2 L 9.851562 2 L 11.300781 3.625 Z M 13.699219 3.625 "/>
</g>
</svg>
<span class="meta__text"><a class="meta__link" href="/zh-tw/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/" rel="category">程式語言</a>
	</span>
</div>
<div class="meta__item-translations meta__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
class="meta__icon icon icon-author"
width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(29.019608%,29.019608%,29.019608%);fill-opacity:1;" d="M 2 5.121094 L 2 13.109375 C 2 13.484375 2.25 13.617188 2.554688 13.410156 L 5.445312 11.488281 C 5.75 11.28125 6.25 11.28125 6.554688 11.488281 L 9.445312 13.410156 C 9.75 13.617188 10.25 13.617188 10.554688 13.410156 L 13.445312 11.488281 C 13.75 11.28125 14 10.816406 14 10.445312 L 14 2.453125 C 14 2.082031 13.75 1.949219 13.445312 2.152344 L 10.554688 4.078125 C 10.25 4.28125 9.75 4.28125 9.445312 4.078125 L 6.554688 2.152344 C 6.25 1.949219 5.75 1.949219 5.445312 2.152344 L 2.554688 4.078125 C 2.25 4.28125 2 4.75 2 5.121094 Z M 0.667969 5.121094 C 0.667969 4.304688 1.140625 3.421875 1.816406 2.96875 L 4.703125 1.042969 C 5.460938 0.539062 6.542969 0.542969 7.296875 1.042969 L 10.183594 2.96875 C 10.042969 2.875 9.957031 2.875 9.816406 2.96875 L 12.703125 1.042969 C 13.898438 0.246094 15.332031 1.019531 15.332031 2.453125 L 15.332031 10.445312 C 15.332031 11.261719 14.859375 12.144531 14.183594 12.597656 L 11.296875 14.519531 C 10.539062 15.023438 9.457031 15.023438 8.703125 14.519531 L 5.816406 12.597656 C 5.957031 12.691406 6.042969 12.691406 6.183594 12.597656 L 3.296875 14.519531 C 2.101562 15.316406 0.667969 14.542969 0.667969 13.109375 Z M 5.332031 1.78125 L 6.667969 1.78125 L 6.667969 11.78125 L 5.332031 11.78125 Z M 9.332031 3.78125 L 10.667969 3.78125 L 10.667969 13.78125 L 9.332031 13.78125 Z M 9.332031 3.78125 "/>
</g>
</svg>
<span class="meta__text"><a class="meta__link" href="/tutorials/aspnetcore-6.0-signalr-websocket-2/">EN</a>　
	</span>
</div>

				
				
				
				<span>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="meta__icon icon icon-clock"  width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(29.019608%,29.019608%,29.019608%);fill-opacity:1;" d="M 8 12.667969 C 10.578125 12.667969 12.667969 10.578125 12.667969 8 C 12.667969 5.421875 10.578125 3.332031 8 3.332031 C 5.421875 3.332031 3.332031 5.421875 3.332031 8 C 3.332031 10.578125 5.421875 12.667969 8 12.667969 Z M 3.957031 12.433594 C 2.753906 11.335938 2 9.757812 2 8 C 2 4.6875 4.6875 2 8 2 C 11.3125 2 14 4.6875 14 8 C 14 9.757812 13.246094 11.335938 12.042969 12.433594 L 12.9375 13.328125 C 13.207031 13.597656 13.203125 14.015625 12.941406 14.277344 C 12.679688 14.539062 12.257812 14.535156 11.996094 14.273438 L 10.949219 13.226562 C 10.078125 13.71875 9.070312 14 8 14 C 6.929688 14 5.921875 13.71875 5.050781 13.226562 L 4.003906 14.273438 C 3.738281 14.539062 3.316406 14.535156 3.058594 14.277344 C 2.796875 14.015625 2.796875 13.589844 3.0625 13.328125 Z M 7.332031 5.335938 C 7.332031 4.964844 7.628906 4.667969 8 4.667969 C 8.367188 4.667969 8.667969 4.957031 8.667969 5.335938 L 8.667969 9.332031 L 7.332031 9.332031 Z M 5.332031 8.667969 C 5.332031 8.296875 5.628906 8 6 8 L 7.332031 8 L 7.332031 9.332031 L 6 9.332031 C 5.632812 9.332031 5.332031 9.039062 5.332031 8.667969 Z M 5.332031 8.667969 "/>
</g>
</svg>
9 min read.　</span>
				
			
				
				
			</div>
			

			<div id="fb-root"></div>
			<script async defer crossorigin="anonymous"
				src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v16.0&appId=725315935966817&autoLogAppEvents=1"
				nonce="aF40iZ15"></script>
		</header>
		
	<figure class="post__thumbnail thumbnail">
		
		<img class="thumbnail__image" src="/img/thumbnail/034.webp" alt=".NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-2">
		
	</figure>
	
<div class="post__toc toc">
	<div class="toc__title">目錄</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#前言foreword">前言Foreword</a></li>
        <li><a href="#原理principle">原理Principle</a></li>
        <li><a href="#將使用者綁定至連線id">將使用者綁定至連線ID</a></li>
        <li><a href="#實作">實作</a></li>
        <li><a href="#前端程式碼">前端程式碼</a></li>
        <li><a href="#測試結果">測試結果</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p>使用.NET 6 Web API 建立 WebSocket 通訊，本篇紀錄模擬將使用者對應至連線ID並儲存與發送訊息功能的測試過程。</p>
<h3 id="前言foreword">前言Foreword</h3>
<p>上一篇已經介紹了全推播的使用方法，只要有連線上的使用者都能接收到訊息，接下來要模擬對特定使用者進行推播的功能。</p>
<h3 id="原理principle">原理Principle</h3>
<p>WebSocket 通訊，只要使用者連線就會自動生成一個連線ID，若程式邏輯是使用者執行某項操作時，就對其推播訊息，是非常容易的，只要針對當下的連線ID發送推播即可。但實際上邏輯可能更複雜，通常會是使用者A執行某項操作，或是想直接對另一使用者B發送推播，這時就必須針對特定的使用者ID與連線ID進行綁定，這樣在進行推播時，才能藉由已知的使用者ID取得連線ID並推播。</p>
<h3 id="將使用者綁定至連線id">將使用者綁定至連線ID</h3>
<p>通常在使用者連線時即需同時儲存使用者ID與連線ID，在實際要推播時才能查詢使用者對應的連線ID，方法主要分為<code>儲存至記憶體與資料庫</code>，儲存在記憶體的優點是效能較好，但若伺服器重啟相關資訊則會遺失;儲存在資料庫則可以永久儲存資料，缺點則是效能會較差一點。至於要選擇使用哪一種則需要考慮實際的應用情況。</p>
<p>詳細資訊可以查閱教程: <a href="https://learn.microsoft.com/en-us/aspnet/signalr/overview/guide-to-the-api/mapping-users-to-connections" title="Mapping SignalR Users to Connections" target="_blank" rel="noopener">Mapping SignalR Users to Connections</a></p>
<h3 id="實作">實作</h3>
<p>預設使用者連線時需輸入使用者名稱，在按下登入時，會將使用者名稱傳給後端，後端立即將使用者名稱綁定此連線ID。後續若要傳遞給特定使用者，只要從儲存的數據中查詢使用者對應的連線ID，再傳送資訊即可。</p>
<p>過程大致如下:</p>
<hr>
<p><code>輸入使用者名稱 ➜ 綁定使用者名稱與連線ID並儲存</code></p>
<p><code>使用者B傳遞訊息給A ➜ 搜尋已儲存的使用者名稱A ➜ 取得連線ID並傳送</code></p>
<p><code>使用者離線 ➜ 刪除已儲存的連線ID</code></p>
<hr>
<p>在 Hub/IMessageHub.cs 新增兩個介面:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">namespace</span> SignalR_Example.Hub
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IMessageHub</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>        Task sendToAllConnections(List&lt;<span style="color:#66d9ef">string</span>&gt; message);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>        Task JsonDataTransfer(<span style="color:#66d9ef">dynamic</span> message);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>        Task StringDataTransfer(<span style="color:#66d9ef">string</span> message);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span>}
</span></span></code></pre></div><p><code>JsonDataTransfer</code> 用來傳遞 JSON 物件</p>
<p><code>StringDataTransfer</code> 用來傳遞字串</p>
<hr>
<p>在 Hub/MessageHub.cs 新增幾個功能如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Dictionary&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>&gt; userInfoDict = <span style="color:#66d9ef">new</span> Dictionary&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>&gt;();
</span></span></code></pre></div><p>因為只是模擬，資料的儲存僅使用記憶體儲存。</p>
<p>userInfoDict 的 key 為使用者名稱，value 為 連線ID。</p>
<div id="block1"></div>
<script>
    var myDiv = document.getElementById("block1");
    for (var i = 0; i <  3 ; i++) {
      var brTag = document.createElement("br");
      myDiv.appendChild(brTag);
    }
</script>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task LoadUserInfo(<span style="color:#66d9ef">dynamic</span> message)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">dynamic</span> dynParam = JsonConvert.DeserializeObject(Convert.ToString(message));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> userID = dynParam.userId;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> ID = Context.ConnectionId;
</span></span><span style="display:flex;"><span>    userInfoDict[userID] = ID;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> Clients.Client(ID).StringDataTransfer(<span style="color:#e6db74">&#34;Login successfully.&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>模擬前端在使用者登入時，傳送Json物件給後端，儲存在userInfoDict後，會呼叫<code>StringDataTransfer</code>傳遞<code>登入成功</code>給前端。</p>
<p><code>Context.ConnectionId</code> 是 SignalR 套件中的一個屬性，用於取得目前連線的 Connection ID。</p>
<div id="block2"></div>
<script>
    var myDiv = document.getElementById("block2");
    for (var i = 0; i <  3 ; i++) {
      var brTag = document.createElement("br");
      myDiv.appendChild(brTag);
    }
</script>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task SendToConnection(<span style="color:#66d9ef">string</span> userID, <span style="color:#66d9ef">string</span> message)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (userInfoDict.ContainsKey(userID))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> Clients.Client(userInfoDict[userID]).StringDataTransfer(message);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>模擬前端使用者傳訊息給另一使用者，藉由 userID，查詢<code>userInfoDict</code>是否有連線ID，若有則藉由<code>StringDataTransfer</code>傳遞字串。</p>
<div id="block3"></div>
<script>
    var myDiv = document.getElementById("block3");
    for (var i = 0; i <  3 ; i++) {
      var brTag = document.createElement("br");
      myDiv.appendChild(brTag);
    }
</script>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Automatically obtaining the connection ID</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> Task OnConnectedAsync()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//string userId = Context.User.Identity.Name;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> connectionId = Context.ConnectionId;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">base</span>.OnConnectedAsync();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>此為SignalR內建的方法，若使用者連線，即可進入此方法。因模擬為使用者需先輸入userID，所以並沒有在這部分測試。</p>
<div id="block4"></div>
<script>
    var myDiv = document.getElementById("block4");
    for (var i = 0; i <  3 ; i++) {
      var brTag = document.createElement("br");
      myDiv.appendChild(brTag);
    }
</script>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// Disconnecting and automatically removing the connection ID</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;param name=&#34;exception&#34;&gt;&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> Task OnDisconnectedAsync(Exception exception)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> ID = Context.ConnectionId;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> userID = <span style="color:#66d9ef">string</span>.Empty;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (userInfoDict.ContainsValue(ID))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> key = userInfoDict.FirstOrDefault(x =&gt; x.Value == ID).Key;
</span></span><span style="display:flex;"><span>        userInfoDict.Remove(key);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">base</span>.OnDisconnectedAsync(exception);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>此為SignalR內建的方法，若使用者離線，即可進入此方法，模擬使用者離線，即移除儲存在<code>userInfoDict</code>的連線資料。</p>
<p>以上兩種內建方法，可以自行下中斷點測試。</p>
<p>Hub/MessageHub.cs 完整程式碼:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#66d9ef">namespace</span> SignalR_Example.Hub
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MessageHub</span>: Hub&lt;IMessageHub&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task sendToAllConnections(List&lt;<span style="color:#66d9ef">string</span>&gt; message)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>            <span style="color:#66d9ef">await</span> Clients.All.sendToAllConnections(message);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Dictionary&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>&gt; userInfoDict = <span style="color:#66d9ef">new</span> Dictionary&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>&gt;();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task LoadUserInfo(<span style="color:#66d9ef">dynamic</span> message)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>            <span style="color:#66d9ef">dynamic</span> dynParam = JsonConvert.DeserializeObject(Convert.ToString(message));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>            <span style="color:#66d9ef">string</span> userID = dynParam.userId;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>            <span style="color:#66d9ef">var</span> ID = Context.ConnectionId;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>            userInfoDict[userID] = ID;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>            <span style="color:#66d9ef">await</span> Clients.Client(ID).StringDataTransfer(<span style="color:#e6db74">&#34;Login successfully.&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task SendToConnection(<span style="color:#66d9ef">string</span> userID, <span style="color:#66d9ef">string</span> message)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>            <span style="color:#66d9ef">if</span> (userInfoDict.ContainsKey(userID))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>            {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>                <span style="color:#66d9ef">await</span> Clients.Client(userInfoDict[userID]).StringDataTransfer(message);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>        <span style="color:#75715e">/// Automatically obtaining the connection ID</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>        <span style="color:#75715e">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> Task OnConnectedAsync()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>            <span style="color:#75715e">//string userId = Context.User.Identity.Name;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>            <span style="color:#66d9ef">string</span> connectionId = Context.ConnectionId;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">base</span>.OnConnectedAsync();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>        <span style="color:#75715e">/// &lt;summary&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>        <span style="color:#75715e">/// Disconnecting and automatically removing the connection ID</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>        <span style="color:#75715e">/// &lt;/summary&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>        <span style="color:#75715e">/// &lt;param name=&#34;exception&#34;&gt;&lt;/param&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>        <span style="color:#75715e">/// &lt;returns&gt;&lt;/returns&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> Task OnDisconnectedAsync(Exception exception)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>            <span style="color:#66d9ef">string</span> ID = Context.ConnectionId;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span>            <span style="color:#66d9ef">string</span> userID = <span style="color:#66d9ef">string</span>.Empty;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>            <span style="color:#66d9ef">if</span> (userInfoDict.ContainsValue(ID))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>            {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>                <span style="color:#66d9ef">string</span> key = userInfoDict.FirstOrDefault(x =&gt; x.Value == ID).Key;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>                userInfoDict.Remove(key);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">base</span>.OnDisconnectedAsync(exception);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span>}
</span></span></code></pre></div><hr>
<p>在Controllers/MsgController.cs 新增一個對特定使用者傳資訊的API，模擬藉由API啟動即時通訊。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#a6e22e">[HttpPost]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#a6e22e">[Route(&#34;toUser&#34;)]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> toUser([FromBody] JsonElement jobj)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    <span style="color:#66d9ef">var</span> userID = jobj.GetProperty(<span style="color:#e6db74">&#34;userID&#34;</span>).GetString();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#66d9ef">var</span> Msg = jobj.GetProperty(<span style="color:#e6db74">&#34;msg&#34;</span>).GetString();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style="color:#66d9ef">if</span> (MessageHub.userInfoDict.ContainsKey(userID))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>        messageHub.Clients.Client(MessageHub.userInfoDict[userID]).StringDataTransfer(Msg);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Msg sent successfully to user!&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Msg sent failed to user!&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>}
</span></span></code></pre></div><h3 id="前端程式碼">前端程式碼</h3>
<p>接下來，就是前端的畫面顯示，因為主要是測試連線的功能，前端所收到的訊息為了方便都會顯示在console上。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-HTML" data-lang="HTML"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span> /&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>    &lt;<span style="color:#f92672">title</span>&gt;SignalR TEST &lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/@microsoft/signalr@5.0.7/dist/browser/signalr.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>        <span style="color:#75715e">// 建立 SignalR Hub 連線
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hubConnection</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">signalR</span>.<span style="color:#a6e22e">HubConnectionBuilder</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>            .<span style="color:#a6e22e">withUrl</span>(<span style="color:#e6db74">&#34;https://localhost:7013/messageHub/&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>            .<span style="color:#a6e22e">build</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>        <span style="color:#a6e22e">hubConnection</span>.<span style="color:#a6e22e">start</span>()
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>            .<span style="color:#a6e22e">then</span>(() =&gt; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>                <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Connection started&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>            });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>        <span style="color:#75715e">// 使用者點擊Login按鈕時的處理函式
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onLoginClick</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>            <span style="color:#75715e">// 取得使用者輸入的使用者ID
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">userId</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;userIdInput&#34;</span>).<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>            <span style="color:#75715e">// 將使用者ID包成 JSON 格式
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jsonData</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>                <span style="color:#e6db74">&#34;userId&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">userId</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>            };
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>            <span style="color:#75715e">// 使用 SignalR Hub 的 LoadUserInfo 方法，將 JSON 資料傳送至後端
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">hubConnection</span>.<span style="color:#a6e22e">invoke</span>(<span style="color:#e6db74">&#34;LoadUserInfo&#34;</span>, <span style="color:#a6e22e">jsonData</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>                .<span style="color:#a6e22e">then</span>(() =&gt; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>                    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Data sent successfully!&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>                })
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>                .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">error</span>) =&gt; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>                    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>                });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>        <span style="color:#75715e">// 使用者點擊Send按鈕時的處理函式
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onSendClick</span>() {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>            <span style="color:#75715e">// 取得使用者輸入的使用者ID
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">userId</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;msgUserIdInput&#34;</span>).<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>            <span style="color:#75715e">// 取得使用者輸入的訊息
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">msg</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;msgInput&#34;</span>).<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>            <span style="color:#75715e">// 使用 SignalR Hub 的 SendToConnection 方法，將資料傳送至另一使用者
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">hubConnection</span>.<span style="color:#a6e22e">invoke</span>(<span style="color:#e6db74">&#34;SendToConnection&#34;</span>, <span style="color:#a6e22e">userId</span>, <span style="color:#a6e22e">msg</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>                .<span style="color:#a6e22e">then</span>(() =&gt; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>                    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Msg sent successfully!&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>                })
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>                .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">error</span>) =&gt; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>                    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span>                });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span>        <span style="color:#75715e">// 註冊 MessageHub 的事件
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#34;sendToAllConnections&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">msgs</span>) {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;To All Connections:&#34;</span>, <span style="color:#a6e22e">msgs</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span>        });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span>        <span style="color:#a6e22e">hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#34;StringDataTransfer&#34;</span>, (<span style="color:#a6e22e">response</span>) =&gt; {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Received Msg:&#34;</span>, <span style="color:#a6e22e">response</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span>        });
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span>        
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span><span>    SignalR TEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span><span>    &lt;<span style="color:#f92672">hr</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;userIdInput&#34;</span>&gt;Please enter user ID：&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;userIdInput&#34;</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75</span><span>    &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;onLoginClick()&#34;</span>&gt;Login&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76</span><span>    &lt;<span style="color:#f92672">hr</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77</span><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msgUserIdInput&#34;</span>&gt;User ID：&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78</span><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msgUserIdInput&#34;</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79</span><span>    &lt;<span style="color:#f92672">label</span> <span style="color:#a6e22e">for</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msgInput&#34;</span>&gt;msg:&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80</span><span>    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;msgInput&#34;</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81</span><span>    &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;onSendClick()&#34;</span>&gt;Send&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83</span><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84</span><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h3 id="測試結果">測試結果</h3>
<p>測試時，可以開啟多個網頁，在登入時使用不同的userID，過程中可以開啟中段點，查看執行的過程。</p>
<p>





<figure>
    <div class="image-container">
        
    <img  src="/img/lazyloading.webp" data-src="pics/B.png" width="80%" alt="" class="lazy">
    
    <figcaption>使用者 B 登入，並傳訊息給使用者 A</figcaption>
    </div>
</figure><br>






<figure>
    <div class="image-container">
        
    <img  src="/img/lazyloading.webp" data-src="pics/A.png" width="80%" alt="" class="lazy">
    
    <figcaption>使用者 A 的介面，確認收到訊息</figcaption>
    </div>
</figure></p>
<p>以上為使用 Web API 簡單的實踐即時通訊功能方式。過程包含綁定使用者、連線ID 並儲存，且提供對特定使用者即時通訊的API。雖然前端畫面有點簡陋，但主要是為了解其中原理，我想應該是任何功能都可以實現了吧。</p>
<p>專案已上傳至
<a href="https://github.com/zhongyousun/SignalR-example" title="Github" target="_blank" rel="noopener">Github</a>。</p>
		</div>
		<br>
		<br>
		
		<br>  
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/zh-tw/tags/web/" rel="tag">Web</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/zh-tw/tags/csharp/" rel="tag">Csharp</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/zh-tw/tags/javascript/" rel="tag">JavaScript</a>
		</li>
	</ul>
</div>
			
			









<style>
    .sharebuttons {
        position:relative;
        float: right;
    }
    .sharebuttons ul {
        list-style: none;
        margin-right: 10px;
        padding: 0;
    }
    .sharebuttons ul li {
        display: inline-block;
        margin-left: 10px;
    }
</style>

<nav class="sharebuttons">
    <span>:</span>
     <ul>
        <li><a href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f&t=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2" target="_blank"><svg height="50" viewBox="0 0 50 50" width="50" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m12.8064516 26.63h5.4808065v22.5635484c0 .4454839.3609677.8064516.8064516.8064516h9.2929032c.4454839 0 .8064516-.3609677.8064516-.8064516v-22.4572581h6.3006452c.4096774 0 .7543548-.3074193.801129-.7143548l.9569355-8.3067742c.0262903-.2285484-.046129-.4574194-.1990323-.628871-.1530645-.1716129-.3720967-.2698387-.6019354-.2698387h-7.2574194v-5.2070968c0-1.5696774.8451613-2.36564512 2.5122581-2.36564512h4.7451613c.4454838 0 .8064516-.36112903.8064516-.80645162v-7.6248387c0-.44548388-.3609678-.80645162-.8064516-.80645162h-6.5395162c-.046129-.00225806-.1485484-.00596774-.2995161-.00596774-1.1346774 0-5.0787097.22274194-8.1941936 3.08887097-3.4519354 3.17612903-2.9720967 6.97903223-2.8574193 7.63838713v6.0890322h-5.7537097c-.4454839 0-.8064516.3609678-.8064516.8064516v8.2006452c0 .4454839.3609677.8066129.8064516.8066129z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/><path d="m0 0h50v50h-50z"/></g></svg></a></li>
        <li><a href="https://twitter.com/share?text=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2&url=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><style>svg{fill:#c4c4c4}</style><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/></svg></a></li>
        <li><a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f&title=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2&summary=%253Cp%253E%25E4%25BD%25BF%25E7%2594%25A8.NET%2b6%2bWeb%2bAPI%2b%25E5%25BB%25BA%25E7%25AB%258B%2bWebSocket%2b%25E9%2580%259A%25E8%25A8%258A%25EF%25BC%258C%25E6%259C%25AC%25E7%25AF%2587%25E7%25B4%2580%25E9%258C%2584%25E6%25A8%25A1%25E6%2593%25AC%25E5%25B0%2587%25E4%25BD%25BF%25E7%2594%25A8%25E8%2580%2585%25E5%25B0%258D%25E6%2587%2589%25E8%2587%25B3%25E9%2580%25A3%25E7%25B7%259AID%25E4%25B8%25A6%25E5%2584%25B2%25E5%25AD%2598%25E8%2588%2587%25E7%2599%25BC%25E9%2580%2581%25E8%25A8%258A%25E6%2581%25AF%25E5%258A%259F%25E8%2583%25BD%25E7%259A%2584%25E6%25B8%25AC%25E8%25A9%25A6%25E9%2581%258E%25E7%25A8%258B%25E3%2580%2582%253C%252Fp%253E" target="_blank"><svg height="51" viewBox="0 0 50 51" width="50" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m37.17 16.2290323c11.3056452 0 12.83 8.1724193 12.83 16.1667742v17.6877419c0 .4454839-.3609677.8064516-.8064516.8064516h-10.0193549c-.4454838 0-.8064516-.3609677-.8064516-.8064516l-.0003842-15.9301537c-.0134805-4.2654904-.4024632-7.4953302-4.4055835-7.4953302-3.7477419 0-5.2080645 2.0945161-5.2080645 7.4708065v15.9545161c0 .4454839-.3609678.8066129-.8064516.8066129h-10.0156452c-.4454839 0-.8064516-.361129-.8064516-.8066129v-32.2464516c0-.4453226.3609677-.8064516.8064516-.8064516h9.6127419c.4454839 0 .8064517.361129.8064517.8064516v2.0943548c1.8075806-1.9691935 4.7877419-3.702258 8.8191935-3.702258zm-25.5312903.8014516c.4454838 0 .8064516.361129.8064516.8064516v32.2464516c0 .4454839-.3609678.8064516-.8064516.8064516h-10.03758067c-.44548387 0-.80645161-.3609677-.80645161-.8064516v-32.2464516c0-.4453226.36096774-.8064516.80645161-.8064516zm-5.01516131-16.0304839c3.64935481 0 6.61838711 2.96806452 6.61822581 6.61629032 0 3.64967738-2.968871 6.61903228-6.61822581 6.61903228-3.65225807 0-6.62354839-2.9691936-6.62354839-6.61903228 0-3.6482258 2.97129032-6.61629032 6.62354839-6.61629032z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/><path d="m0 0h50v50h-50z"/></g></svg></a></li>
        <li><a href="whatsapp://send?text=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2%0a%0a%3cp%3e%e4%bd%bf%e7%94%a8.NET%206%20Web%20API%20%e5%bb%ba%e7%ab%8b%20WebSocket%20%e9%80%9a%e8%a8%8a%ef%bc%8c%e6%9c%ac%e7%af%87%e7%b4%80%e9%8c%84%e6%a8%a1%e6%93%ac%e5%b0%87%e4%bd%bf%e7%94%a8%e8%80%85%e5%b0%8d%e6%87%89%e8%87%b3%e9%80%a3%e7%b7%9aID%e4%b8%a6%e5%84%b2%e5%ad%98%e8%88%87%e7%99%bc%e9%80%81%e8%a8%8a%e6%81%af%e5%8a%9f%e8%83%bd%e7%9a%84%e6%b8%ac%e8%a9%a6%e9%81%8e%e7%a8%8b%e3%80%82%3c%2fp%3e%0a%0ahttp%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f%0a" target="_blank"><svg height="50" viewBox="0 0 50 50" width="50" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m25.4437935 0c13.5404221 0 24.5561688 10.9340909 24.5561688 24.3738636 0 13.4383117-11.0157467 24.3712663-24.5560065 24.3711039-4.0610389 0-8.0737013-1.0012987-11.624026-2.8982143l-12.97402593 4.1227273c-.06461039.0206169-.13084416.0305195-.19659091.0305195-.17159091 0-.33961039-.0681818-.46347403-.1946429-.17159091-.1746753-.23003247-.4311688-.15146104-.6631493l4.21801948-12.4423701c-2.20373376-3.724026-3.36704545-7.9790585-3.36704545-12.3259741 0-13.4397727 11.01688308-24.3738636 24.55844158-24.3738636zm-.0001624 5.07727273c-10.725974 0-19.45227269 8.65649347-19.45227269 19.29659087 0 4.0896104 1.28068182 8.0008117 3.70340909 11.3112013.125.1707793.15892857.3917208.09107143.5920455l-2.09805195 6.1897727 6.49918832-2.0659091c.064448-.0204545.1306818-.0305195.1967532-.0305195.125 0 .2491884.036039.3561689.1063312 3.1814935 2.0876624 6.8826298 3.1910714 10.7038961 3.1910714 10.7248376 0 19.4498376-8.6551948 19.4498376-19.2939935 0-10.6400974-8.7253246-19.29659087-19.45-19.29659087zm-6.6467532 7.85259737c.7225649 0 1.2425325.4384741 1.636039 1.3801948.1636363.3902598 1.7027597 4.1048702 1.788961 4.2772728.1050325.2060065.4300325.8439935.049513 1.6l-.0816559.1641233c-.1558441.3159091-.2902597.5886364-.5922078.9399351-.0969155.112013-.1956168.2308442-.2941558.349513-.2081169.250487-.4232143.5094156-.6217532.7058441-.0678572.0680195-.1993507.1998377-.2136364.2522728.000487 0 .0029221.0449675.0610389.1439935.4069806.6887987 3.375 4.7733766 7.2852273 6.4719156.1707792.0741883.7349026.3064935.7675325.3064935.0363636 0 .0970779-.0607143.1415584-.111526.3405844-.3849026 1.4428572-1.6733766 1.8069806-2.2146104.3220779-.4818182.7355519-.7271104 1.2277597-.7271104.3012987 0 .5845779.0926948.849026.1876624.6030564.2170398 3.8043369 1.7879312 4.3216328 2.0413055l.0686269.0335321c.4774351.2292208.8545455.4102273 1.0733766.7699676.3194805.5290584.1928572 1.9868506-.2873376 3.3211038-.609578 1.6939936-3.2894481 3.0826299-4.5089286 3.1907468l-.1788961.0170455c-.2819805.0277597-.6016234.0590909-1.000974.0590909l-.0944191-.0005452c-.9658464-.0112678-2.6415309-.2079278-6.0576913-1.5725068-3.6667208-1.4647727-7.2837663-4.6050325-10.1852273-8.8423701-.0501623-.0733766-.0847403-.124513-.1035714-.1496753-.7576299-.998539-2.5222403-3.624026-2.5222403-6.4047078 0-3.0896104 1.4788961-4.8464286 2.3530844-5.397565.8243507-.5196428 2.6887987-.7650974 3.0311689-.7795454.0351461-.0014814.0648513-.0027775.0900577-.0039117l.1047884-.0050457c.0548951-.0028933.0444193-.0028933.0863227-.0028933z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/><path d="m0 0h50v50h-50z"/></g></svg></a></li>
        
        <li><a href="mailto:?subject=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2&body=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2%0a%0a%3cp%3e%e4%bd%bf%e7%94%a8.NET%206%20Web%20API%20%e5%bb%ba%e7%ab%8b%20WebSocket%20%e9%80%9a%e8%a8%8a%ef%bc%8c%e6%9c%ac%e7%af%87%e7%b4%80%e9%8c%84%e6%a8%a1%e6%93%ac%e5%b0%87%e4%bd%bf%e7%94%a8%e8%80%85%e5%b0%8d%e6%87%89%e8%87%b3%e9%80%a3%e7%b7%9aID%e4%b8%a6%e5%84%b2%e5%ad%98%e8%88%87%e7%99%bc%e9%80%81%e8%a8%8a%e6%81%af%e5%8a%9f%e8%83%bd%e7%9a%84%e6%b8%ac%e8%a9%a6%e9%81%8e%e7%a8%8b%e3%80%82%3c%2fp%3e%0a%0ahttp%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f%0a" target="_blank"><svg height="50" viewBox="0 0 50 50" width="50" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m46.149789 6h-42.29957803c-2.12025316 0-3.85021097 1.72995781-3.85021097 3.85021097v29.78902953c0 2.1202532 1.72995781 3.850211 3.85021097 3.850211h42.29957803c2.1202532 0 3.850211-1.7299578 3.850211-3.850211v-29.78902953c0-2.12025316-1.7299578-3.85021097-3.850211-3.85021097zm-.5590717 2.84810127-20.3270042 17.38396623-20.32700424-17.38396623zm1.5611814 30.79113923c0 .5485232-.4535865 1.0021097-1.0021097 1.0021097h-42.29957803c-.54852321 0-1.0021097-.4535865-1.0021097-1.0021097v-28.8291139l21.48734173 18.3755274c.0105486.0105485.0316456.0210971.0421941.0316456.0105486.0105485.0316456.021097.0421941.0316455.0316456.0210971.0527426.0421941.0843882.0527427.0105485.0105485.0210971.0105485.0316456.021097.0421941.0210971.0843882.0421941.1265823.0632911.0105485 0 .021097.0105486.0316455.0105486.0316456.0105485.0632912.0316455.1054853.0421941.0105485 0 .0316455.0105485.0421941.0105485.0316455.0105485.0632911.021097.0949367.021097.0105485 0 .0316455.0105486.0421941.0105486.0316455.0105485.0738396.0105485.1054852.021097h.0316456c.042194 0 .0949367.0105485.1371308.0105485.042194 0 .0949367 0 .1371308-.0105485h.0316455c.0316456 0 .0738397-.0105485.1054853-.021097.0105485 0 .0316455-.0105486.0421941-.0105486.0316455-.0105485.0632911-.021097.0949367-.021097.0105485 0 .0316455-.0105485.0421941-.0105485.0316455-.0105486.0632911-.0210971.1054852-.0421941.0105485 0 .021097-.0105486.0316456-.0105486.042194-.021097.0843881-.042194.1265822-.0632911.0105486-.0105485.0210971-.0105485.0316456-.021097.0316456-.0210971.0527426-.0316456.0843882-.0527427.0105485-.0105485.0316456-.021097.0421941-.0316455s.0316456-.0210971.0421941-.0316456l20.9810126-17.9219409z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/><path d="m0 0h50v50h-50z"/></g></svg></a></li>
        <li><a href="https://t.me/share/url?url=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f&text=.NET%206%20Web%20API%20%e4%bd%bf%e7%94%a8SignalR%e5%af%a6%e4%bd%9cWebSocket%e6%8a%80%e8%a1%93%e5%af%a6%e7%8f%be%e5%8d%b3%e6%99%82%e9%80%9a%e8%a8%8a-2%0a%0a%3cp%3e%e4%bd%bf%e7%94%a8.NET%206%20Web%20API%20%e5%bb%ba%e7%ab%8b%20WebSocket%20%e9%80%9a%e8%a8%8a%ef%bc%8c%e6%9c%ac%e7%af%87%e7%b4%80%e9%8c%84%e6%a8%a1%e6%93%ac%e5%b0%87%e4%bd%bf%e7%94%a8%e8%80%85%e5%b0%8d%e6%87%89%e8%87%b3%e9%80%a3%e7%b7%9aID%e4%b8%a6%e5%84%b2%e5%ad%98%e8%88%87%e7%99%bc%e9%80%81%e8%a8%8a%e6%81%af%e5%8a%9f%e8%83%bd%e7%9a%84%e6%b8%ac%e8%a9%a6%e9%81%8e%e7%a8%8b%e3%80%82%3c%2fp%3e%0a%0ahttp%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f%0a" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 496 512"><style>svg{fill:#cccccc}</style><path d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/></svg></a></li>
        <li><a href="https://social-plugins.line.me/lineit/share?url=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f"  target="_blank"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc.<style>svg{fill:#d4d4d4}</style><path d="M311 196.8v81.3c0 2.1-1.6 3.7-3.7 3.7h-13c-1.3 0-2.4-.7-3-1.5l-37.3-50.3v48.2c0 2.1-1.6 3.7-3.7 3.7h-13c-2.1 0-3.7-1.6-3.7-3.7V196.9c0-2.1 1.6-3.7 3.7-3.7h12.9c1.1 0 2.4 .6 3 1.6l37.3 50.3V196.9c0-2.1 1.6-3.7 3.7-3.7h13c2.1-.1 3.8 1.6 3.8 3.5zm-93.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 2.1 1.6 3.7 3.7 3.7h13c2.1 0 3.7-1.6 3.7-3.7V196.8c0-1.9-1.6-3.7-3.7-3.7zm-31.4 68.1H150.3V196.8c0-2.1-1.6-3.7-3.7-3.7h-13c-2.1 0-3.7 1.6-3.7 3.7v81.3c0 1 .3 1.8 1 2.5c.7 .6 1.5 1 2.5 1h52.2c2.1 0 3.7-1.6 3.7-3.7v-13c0-1.9-1.6-3.7-3.5-3.7zm193.7-68.1H327.3c-1.9 0-3.7 1.6-3.7 3.7v81.3c0 1.9 1.6 3.7 3.7 3.7h52.2c2.1 0 3.7-1.6 3.7-3.7V265c0-2.1-1.6-3.7-3.7-3.7H344V247.7h35.5c2.1 0 3.7-1.6 3.7-3.7V230.9c0-2.1-1.6-3.7-3.7-3.7H344V213.5h35.5c2.1 0 3.7-1.6 3.7-3.7v-13c-.1-1.9-1.7-3.7-3.7-3.7zM512 93.4V419.4c-.1 51.2-42.1 92.7-93.4 92.6H92.6C41.4 511.9-.1 469.8 0 418.6V92.6C.1 41.4 42.2-.1 93.4 0H419.4c51.2 .1 92.7 42.1 92.6 93.4zM441.6 233.5c0-83.4-83.7-151.3-186.4-151.3s-186.4 67.9-186.4 151.3c0 74.7 66.3 137.4 155.9 149.3c21.8 4.7 19.3 12.7 14.4 42.1c-.8 4.7-3.8 18.4 16.1 10.1s107.3-63.2 146.5-108.2c27-29.7 39.9-59.8 39.9-93.1z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/></svg></a></li>
        <li><a href="https://reddit.com/submit?url=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" title="Share on Reddit" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><style>svg{fill:#d3d4d4}</style><path d="M440.3 203.5c-15 0-28.2 6.2-37.9 15.9-35.7-24.7-83.8-40.6-137.1-42.3L293 52.3l88.2 19.8c0 21.6 17.6 39.2 39.2 39.2 22 0 39.7-18.1 39.7-39.7s-17.6-39.7-39.7-39.7c-15.4 0-28.7 9.3-35.3 22l-97.4-21.6c-4.9-1.3-9.7 2.2-11 7.1L246.3 177c-52.9 2.2-100.5 18.1-136.3 42.8-9.7-10.1-23.4-16.3-38.4-16.3-55.6 0-73.8 74.6-22.9 100.1-1.8 7.9-2.6 16.3-2.6 24.7 0 83.8 94.4 151.7 210.3 151.7 116.4 0 210.8-67.9 210.8-151.7 0-8.4-.9-17.2-3.1-25.1 49.9-25.6 31.5-99.7-23.8-99.7zM129.4 308.9c0-22 17.6-39.7 39.7-39.7 21.6 0 39.2 17.6 39.2 39.7 0 21.6-17.6 39.2-39.2 39.2-22 .1-39.7-17.6-39.7-39.2zm214.3 93.5c-36.4 36.4-139.1 36.4-175.5 0-4-3.5-4-9.7 0-13.7 3.5-3.5 9.7-3.5 13.2 0 27.8 28.5 120 29 149 0 3.5-3.5 9.7-3.5 13.2 0 4.1 4 4.1 10.2.1 13.7zm-.8-54.2c-21.6 0-39.2-17.6-39.2-39.2 0-22 17.6-39.7 39.2-39.7 22 0 39.7 17.6 39.7 39.7-.1 21.5-17.7 39.2-39.7 39.2z" fill="#d5d5d5" class="will-change" fill-rule="nonzero"/></svg></a></li>
    
    </ul>
</nav>
<style>
.sharebuttons, .sharebuttons ul {display: flex; margin: 0.25rem 0;margin-top: -0.35rem; align-items: center;}
.sharebuttons span {color: #bbb;}
.sharebuttons ul li {list-style: none; margin: 0;}
.sharebuttons ul li a {margin: 0 0.5rem; display: block;}
.sharebuttons ul li:first-child a {margin: 0 0.2rem 0 0.5rem;}
.sharebuttons ul li a svg {width: auto; height: 1.4rem; display: block; margin-right: 5px;}
.will-change {transition: 250ms;} 
nav.sharebuttons li > a:hover .will-change { fill: #444444 }
</style>

		</footer>
		<hr>
		<div id="type-effect">
</div>
<br>
<br>
<br>
<br>
<iframe class="LikeCoin" height="180" src="https://button.like.co/in/embed/sunnote/button?referrer=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f" width="80%" frameborder=0></iframe>

<style>
	#type-effect {
	  white-space: nowrap;
	  overflow: hidden;
	  font-size: 20px;
	  font-family: monospace, sans-serif  ;
	  border-right: 1px solid rgb(255, 255, 255);
	   
	  padding-right: 5px;
	  white-space: pre-wrap;
	  position: absolute;
    
	}
  </style>
  <script>
  	var url = window.location.href;
	var ln = "en";
	if (url.indexOf("/zh-tw/") > -1) {
  	ln = "zh";
	}
	if (ln === "zh") {
	  var message = "如果這個文章對您有幫助或是有任何疑問，歡迎留言。👇"
	  speed = 100
	}
	else {
	  var message = "If this posts was helpful to you or if you have any questions, feel free to leave a comment and ask.👇"
	  speed = 50
	}
  
	const typeEffectDiv = document.getElementById("type-effect");
  
	function typeEffect(message, element) {
	  let i = 0;
	  const interval = setInterval(function () {
		if (i === message.length) {
		  clearInterval(interval);
		  setTimeout(function () {
			element.textContent = "";
			typeEffect(message, element);
		  }, 2000); 
		} else {
		  element.textContent += message[i];
		  i++;
		}
	  }, speed); 

	}
	typeEffect(message, typeEffectDiv);
  </script>

	</article>
</main>



<hr>
<div class="related-content">

<h3>也可以看看</h3>

<div class="owl-carousel owl-theme"> 
	  
	  
	
	 
	<div class="item">
		
			<div class="related-post__image">
				<a href="/zh-tw/tutorials/aspnetcore-6.0-blazor-globalization/">
					<img src="https://sunnote.xyz/img/thumbnail/043.webp" alt="ASP.NET Core Blazor 實作多國語系"/>
					
				</a>
			

			<h6><a href="/zh-tw/tutorials/aspnetcore-6.0-blazor-globalization/">ASP.NET Core Blazor 實作多國語系
				
				<br>
				<time datetime="2023-11-16T03:05:34&#43;0000">
					November 16, 2023
				</time></a></h6>
				</time>
			
			</div>

		
			
		
			
	</div>
   
	<div class="item">
		
			<div class="related-post__image">
				<a href="/zh-tw/tutorials/mongodb-atlas-crud/">
					<img src="https://sunnote.xyz/img/thumbnail/038.webp" alt="使用 .NET 6 進行 MongoDB Atlas CRUD 操作"/>
					
				</a>
			

			<h6><a href="/zh-tw/tutorials/mongodb-atlas-crud/">使用 .NET 6 進行 MongoDB Atlas CRUD 操作
				
				<br>
				<time datetime="2023-08-08T03:24:03&#43;0000">
					August 8, 2023
				</time></a></h6>
				</time>
			
			</div>

		
			
		
			
	</div>
   
	<div class="item">
		
			<div class="related-post__image">
				<a href="/zh-tw/tutorials/aspnetcore-6.0-signalr-websocket-1/">
					<img src="https://sunnote.xyz/img/thumbnail/029.webp" alt=".NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-1"/>
					
				</a>
			

			<h6><a href="/zh-tw/tutorials/aspnetcore-6.0-signalr-websocket-1/">.NET 6 Web API 使用SignalR實作WebSocket技術實現即時通訊-1
				
				<br>
				<time datetime="2023-06-15T08:08:13&#43;0000">
					June 15, 2023
				</time></a></h6>
				</time>
			
			</div>

		
			
		
			
	</div>
   
	<div class="item">
		
			<div class="related-post__image">
				<a href="/zh-tw/tutorials/dark-mode-tips-hugo/">
					<img src="https://sunnote.xyz/img/thumbnail/024.webp" alt="黑暗模式(dark mode)設計與Hugo實作"/>
					
				</a>
			

			<h6><a href="/zh-tw/tutorials/dark-mode-tips-hugo/">黑暗模式(dark mode)設計與Hugo實作
				
				<br>
				<time datetime="2023-03-22T03:34:07&#43;0000">
					March 22, 2023
				</time></a></h6>
				</time>
			
			</div>

		
			
		
			
	</div>
   
	<div class="item">
		
			<div class="related-post__image">
				<a href="/zh-tw/tutorials/jwt-authentication-mechanism/">
					<img src="https://sunnote.xyz/img/thumbnail/022.png" alt="JWT 驗證機制原理與實作範例 (C#)"/>
					
				</a>
			

			<h6><a href="/zh-tw/tutorials/jwt-authentication-mechanism/">JWT 驗證機制原理與實作範例 (C#)
				
				<br>
				<time datetime="2023-03-06T08:05:44&#43;0000">
					March 6, 2023
				</time></a></h6>
				</time>
			
			</div>

		
			
		
			
	</div>
   
	<div class="item">
		
			<a href="/zh-tw/tutorials/sql-partition-by/">
				<div style="height: 7.5rem; background-color: #ACD6FF; color: rgb(93, 93, 93); padding: 10px; border-radius: 5px;">
					<h6 style="color: rgb(249, 248, 248); font-weight: bold; text-align: center;">SQL-partition by 實現資料分組
						
						<hr style="border-color: #ACD6FF;">
						<div style="font-weight:lighter; text-align: right; font-size:5px;">
						<time datetime="2023-02-07T00:00:00&#43;0000">
							February 7, 2023
						</time>
						</div>
					</h6>
				</div>
			</a>
				
				<h6><a href="/zh-tw/tutorials/sql-partition-by/">使用SQL partition by 實現資料分割，比較LINQ與partition by效能。
</a></h6>

		
			
		
			
	</div>
   
	<div class="item">
		
			<a href="/zh-tw/tutorials/csharp-multithreading/">
				<div style="height: 7.5rem; background-color: #ACD6FF; color: rgb(93, 93, 93); padding: 10px; border-radius: 5px;">
					<h6 style="color: rgb(249, 248, 248); font-weight: bold; text-align: center;">C# 多執行緒原理、非同步用法與帶入自定義物件
						
						<hr style="border-color: #ACD6FF;">
						<div style="font-weight:lighter; text-align: right; font-size:5px;">
						<time datetime="2023-01-19T03:49:15&#43;0000">
							January 19, 2023
						</time>
						</div>
					</h6>
				</div>
			</a>
				
				<h6><a href="/zh-tw/tutorials/csharp-multithreading/">C# 多執行緒原理、非同步用法與帶入自定義物件學習過程紀錄。
目前遇到的專案都沒有硬性需求使用到多執行緒，此篇為紀錄自己的理解與學習的過程。
</a></h6>

		
			
		
			
	</div>
   
	<div class="item">
		
			<a href="/zh-tw/tutorials/csharp-enum/">
				<div style="height: 7.5rem; background-color: #ACD6FF; color: rgb(93, 93, 93); padding: 10px; border-radius: 5px;">
					<h6 style="color: rgb(249, 248, 248); font-weight: bold; text-align: center;">C# Enum(枚舉) 用法紀錄
						
						<hr style="border-color: #ACD6FF;">
						<div style="font-weight:lighter; text-align: right; font-size:5px;">
						<time datetime="2023-01-15T00:49:07&#43;0000">
							January 15, 2023
						</time>
						</div>
					</h6>
				</div>
			</a>
				
				<h6><a href="/zh-tw/tutorials/csharp-enum/">C#-Enum(枚舉)用途與使用擴充方法取得description詳細紀錄。
</a></h6>

		
			
		
			
	</div>
   
	<div class="item">
		
			<div class="related-post__image">
				<a href="/zh-tw/book/just-keep-buying/">
					<img src="https://sunnote.xyz/img/thumbnail/042.webp" alt="投資的最佳實證方法-持續買進(好書推薦)"/>
					
				</a>
			

			<h6><a href="/zh-tw/book/just-keep-buying/">投資的最佳實證方法-持續買進(好書推薦)
				
				<br>
				<time datetime="2023-11-14T23:44:38&#43;0000">
					November 15, 2023
				</time></a></h6>
				</time>
			
			</div>

		
			
		
			
	</div>
   
	<div class="item">
		
			<a href="/zh-tw/life/nasal-septum-inferior-turbinate-hypertrophy-surgery/">
				<div style="height: 7.5rem; background-color: #ACD6FF; color: rgb(93, 93, 93); padding: 10px; border-radius: 5px;">
					<h6 style="color: rgb(249, 248, 248); font-weight: bold; text-align: center;">鼻中膈成形&#43;下鼻甲氣化棒減積手術分享(鼻中膈彎曲&#43;下鼻甲肥大)
						
						<hr style="border-color: #ACD6FF;">
						<div style="font-weight:lighter; text-align: right; font-size:5px;">
						<time datetime="2023-10-06T11:44:38&#43;0000">
							October 6, 2023
						</time>
						</div>
					</h6>
				</div>
			</a>
				
				<h6><a href="/zh-tw/life/nasal-septum-inferior-turbinate-hypertrophy-surgery/">過敏導致鼻中膈彎曲與下鼻甲肥大手術過程與注意事項分享。
</a></h6>

		
			
		
			
	</div>
  
</div>
</div>
<br>
<br>


<script>
window.addEventListener('load', () => {
  const highlightBlocks = document.querySelectorAll('.highlight');
  highlightBlocks.forEach((highlightBlock) => {
    const button = highlightBlock.querySelector('.highlight-copy-btn');
	const code_type = highlightBlock.querySelector('code[data-lang]');
    highlightBlock.addEventListener('mouseover', () => {
      
      if (button) {
        button.style.display = 'block';
      }
    });
	highlightBlock.addEventListener('mouseout', () => {
      
      if (button) {
        button.style.display = 'none';
      }
    });
  });
});



</script>


<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="Alvin avatar" src="/img/avatar.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">
			<a href="../../about/" target="_blank" style="text-decoration:none;">
			關於 Alvin ☀️
		    </a>
		</span>
	</div>
	<div class="authorbox__description">
		不是一個很努力的人，生活就是在耍廢中順便追求點成就感。
	</div>
</div>


<section class="comments">
	
	
</section>

<div>
	<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img
			src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
</div>


<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script> 
<script>
	var owl = $('.owl-carousel');
	owl.owlCarousel({
  loop: true, 
  margin: 10, 
  nav: true, 
  responsive: {
    0: {
      items: 2 
    },
    600: {
      items: 3 
    },
    1000: {
      items: 3 
    }
  }
});
</script>





<style>
	.nav {
		display: inline-flex;
		position: relative;
		overflow: hidden;
		max-width: 100%;
		background-color: var(--wrapperBG);
		padding: 0 20px;
		border-radius: 20px;
		 
		display: flex;
		justify-content: center;
		transition: background-color 1.3s ease, color 0.3s ease;

	}

	.nav-item {
		color: #83818c;
		padding: 20px;
		text-decoration: none;
		transition: .3s;
		margin: 0 6px;
		z-index: 1;
		font-family: 'DM Sans', sans-serif;
		font-weight: 500;
		position: relative;
		transition: inherit;

		&:before {
			content: "";
			position: absolute;
			bottom: -6px;
			left: 0;
			width: 100%;
			height: 5px;
			background-color: #dfe2ea;
			border-radius: 8px 8px 0 0;
			opacity: 0;
			transition: .3s;
		}
	}

	.nav-item:not(.is-active):hover:before {
		opacity: 1;
		bottom: 0;
	}


	.nav-item:not(.is-active):hover {
		color: #333;
	}

	.nav-indicator {
		position: absolute;
		left: 0;
		bottom: 0;
		height: 4px;
		transition: .5s;
		height: 5px;
		z-index: 1;
		border-radius: 8px 8px 0 0;
	}

	.nav-item {
		border: none;
		outline: none;
		background-color:  var(--wrapperBG);
	}

	@media (max-width: 580px) {
		.nav {
			overflow: auto;
		}
	}
</style>
<br>

<nav class="nav">
	<button id="fb-btn" class="nav-item" active-color="#ACD6FF">Facebook</button>
	<button id="github-btn" class="nav-item is-active" active-color="#ACD6FF">Github</button>
	<button id="disqus-btn" class="nav-item" active-color="#ACD6FF">Disqus</button>
	<span class="nav-indicator"></span>
</nav>

<script>
	const indicator = document.querySelector('.nav-indicator');
	const items = document.querySelectorAll('.nav-item');

	function handleIndicator(el) {
		items.forEach(item => {
			item.classList.remove('is-active');
			item.removeAttribute('style');
		});

		indicator.style.width = `${el.offsetWidth}px`;
		indicator.style.left = `${el.offsetLeft}px`;
		indicator.style.backgroundColor = el.getAttribute('active-color');

		el.classList.add('is-active');
		el.style.color = el.getAttribute('active-color');
	}


	items.forEach((item, index) => {
		item.addEventListener('click', (e) => { handleIndicator(e.target) });
		item.classList.contains('is-active') && handleIndicator(item);
	});


</script>
<br><br>


<div id="disqus-comments" class="comments markdown" style="display: none;">
	<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    
    
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'sun';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
</div>



<div id="utterances-comments" class="comments markdown" style="display: block;">
	<script src="https://giscus.app/client.js"
        data-repo="zhongyousun/giscus"
        data-repo-id="R_kgDOJJwIkA"
        data-category="Announcements"
        data-category-id="DIC_kwDOJJwIkM4CU4ky"
        data-mapping="url"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light_protanopia"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
</div>



<div id="facebook-comments" class="fb-comments" data-href="http://sunnote.xyz/zh-tw/tutorials/aspnetcore-6.0-signalr-websocket-2/" data-width="100%" data-numposts="5"
	data-csp="true" data-order-by="reverse_time" style="display: none;"></div>
<script>

	
	const githubBtn = document.getElementById("github-btn");
	const disqusBtn = document.getElementById("disqus-btn");
	const fbBtn = document.getElementById("fb-btn");

	
	const githubBoard = document.getElementById("utterances-comments");
	const disqusBoard = document.getElementById("disqus-comments");
	const fbBoard = document.getElementById("facebook-comments");

	
	githubBtn.addEventListener("click", function () {
		githubBoard.style.display = "block";
		disqusBoard.style.display = "none";
		fbBoard.style.display = "none";
	});
	disqusBtn.addEventListener("click", function () {
		githubBoard.style.display = "none";
		disqusBoard.style.display = "block";
		fbBoard.style.display = "none";
	});
	fbBtn.addEventListener("click", function () {
		githubBoard.style.display = "none";
		disqusBoard.style.display = "none";
		fbBoard.style.display = "block";
	});
</script>



<style>
    .lazy {
  cursor: pointer;
}
	.lazy:hover {
  background-image: white;
}
    .zoomed {
		position: fixed;
  top: 5%;
  left: 5%;
  width: 90vw;
  height: 90vh;
  z-index: 9999;
  cursor: zoom-out;
  object-fit: contain;
  transition: all 1s ;
  background-color: rgba(231, 231, 231, 0.7);  
  border-radius: 10px;
}
 
</style>
<script>

const zoomed = document.querySelectorAll('.image-container');

zoomed.forEach((image) => {
  image.addEventListener('click', () => {
	const img= image.parentNode.querySelector('.lazy');
    img.classList.toggle('zoomed');








  });
});


document.addEventListener('click', (event) => {
  
  const isClickedOnImage = Array.from(images).some((img) => img.contains(event.target));

  
  if (!isClickedOnImage && document.querySelector('.zoomed')) {
    images.forEach((img) => img.classList.remove('zoomed'));
  }
});

</script>


<script src="https://cdn.jsdelivr.net/npm/intersection-observer@0.12.2/intersection-observer.min.js"></script>
<script type="text/javascript">
    const observer = new IntersectionObserver((entries, owner) => {
        for (let entry of entries) {
            if (entry.isIntersecting) {
                
                const img = entry.target;
                img.setAttribute('src', img.dataset.src);
                img.removeAttribute('data-src');
                owner.unobserve(img);
            }
        }
    });
    const images = document.querySelectorAll('img.lazy')
    for (let image of images) {
        observer.observe(image);
    }
</script>



			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">近期文章</h4>
	<div class="widget__content">
		<ul class="widget__list">
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/tutorials/aspnetcore-6.0-blazor-globalization/">ASP.NET Core Blazor 實作多國語系</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/book/just-keep-buying/">投資的最佳實證方法-持續買進(好書推薦)</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/life/nasal-septum-inferior-turbinate-hypertrophy-surgery/">鼻中膈成形&#43;下鼻甲氣化棒減積手術分享(鼻中膈彎曲&#43;下鼻甲肥大)</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/tutorials/hugo-auto-update-last-modified/">Hugo 自動更新文章最後修改日期:簡化管理步驟、提升SEO</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/life/mk870-hand-rest-unboxing/">開箱腹靈MK870機械鍵盤與非洲花梨木質手托</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">分類</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E6%B5%B7%E5%A4%96%E6%97%85%E9%81%8A/">海外旅遊</a>&nbsp;
				<span class="widget__counter widget__counter--bubble"><span class="count">12</span></span>
				
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E7%94%9F%E6%B4%BB%E7%B4%80%E9%8C%84/">生活紀錄</a>&nbsp;
				<span class="widget__counter widget__counter--bubble"><span class="count">14</span></span>
				
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/">程式語言</a>&nbsp;
				<span class="widget__counter widget__counter--bubble"><span class="count">19</span></span>
				
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E7%B4%94%E7%B2%B9%E5%88%86%E4%BA%AB/">純粹分享</a>&nbsp;
				<span class="widget__counter widget__counter--bubble"><span class="count">10</span></span>
				
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E8%8B%B1%E6%96%87%E5%AD%B8%E7%BF%92/">英文學習</a>&nbsp;
				<span class="widget__counter widget__counter--bubble"><span class="count">4</span></span>
				
				</li>
		</ul>
	</div>
</div><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://cse.google.com/cse">
		<label>
			<input class="widget-search__field" type="search" placeholder="站內搜尋…" value="" name="q" aria-label="站內搜尋…">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://sunnote.xyz">
		<input type="hidden" name="cx" value="51cfcdef3e098403d" />
	</form>
</div>

<div class="widget-taglist widget">
	<h4 class="widget__title">標籤</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/blazor/" title="Blazor">Blazor (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/csharp/" title="Csharp">Csharp (<span class="count">8</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/css/" title="CSS">CSS (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/hugo/" title="Hugo">Hugo (<span class="count">4</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/javascript/" title="JavaScript">JavaScript (<span class="count">4</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/leetcode/" title="LeetCode">LeetCode (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/nosql/" title="NoSQL">NoSQL (<span class="count">2</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/python/" title="Python">Python (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/sql/" title="SQL">SQL (<span class="count">6</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/web/" title="Web">Web (<span class="count">5</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E5%8C%97%E6%B5%B7%E9%81%93/" title="北海道">北海道 (<span class="count">3</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E5%8F%B0%E7%81%A3/" title="台灣">台灣 (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E5%A2%BE%E4%B8%81/" title="墾丁">墾丁 (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E5%A5%BD%E6%9B%B8%E5%88%86%E4%BA%AB/" title="好書分享">好書分享 (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E5%AE%BF%E9%9C%A7/" title="宿霧">宿霧 (<span class="count">12</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E6%8A%95%E8%B3%87%E7%90%86%E8%B2%A1/" title="投資理財">投資理財 (<span class="count">2</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E6%97%A5%E6%9C%AC/" title="日本">日本 (<span class="count">3</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E7%94%9F%E6%B4%BB/" title="生活">生活 (<span class="count">4</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%8B%B1%E6%96%87/" title="英文">英文 (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%8F%B2%E5%BE%8B%E8%B3%93/" title="菲律賓">菲律賓 (<span class="count">12</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%99%9B%E6%93%AC%E8%B2%A8%E5%B9%A3/" title="虛擬貨幣">虛擬貨幣 (<span class="count">1</span>)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%AA%9E%E8%A8%80%E5%AD%B8%E6%A0%A1/" title="語言學校">語言學校 (<span class="count">8</span>)</a>
	</div>
</div>


<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
			<script>
				$('.count').each(function () {
				$(this).prop('Counter',0).animate({
					Counter: $(this).text()
				}, {
					duration: 4000,
					easing: 'swing',
					step: function (now) {
						$(this).text(Math.ceil(now));
					}
				});
			});
			</script><a href="https://info.flagcounter.com/8Z5p"><img src="https://s11.flagcounter.com/countxl/8Z5p/bg_FFFFFF/txt_000000/border_FFFFFF/columns_3/maxflags_30/viewers_3/labels_1/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a>
<br>
<br>
<br>






<iframe class="LikeCoin" height="180" src="https://button.like.co/in/embed/sunnote/button?referrer=http%3a%2f%2fsunnote.xyz%2fzh-tw%2ftutorials%2faspnetcore-6.0-signalr-websocket-2%2f" width="80%" frameborder=0></iframe>

</aside>


		</div>
		
<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy;  2022-2023 sunnote.
			<span class="footer__copyright-credits">使用 <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> 技術與 <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>主題</span>

		</div>

	</div>
	
</footer>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6706017277983363"
     crossorigin="anonymous"></script>

<script src="/js/copy-to-clipboard.js"></script>
	</div>
	<script async defer src="/js/menu.js"></script>
	
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

	<div class="floating-menu">
		<button class="main-button"><i class="fas fa-bars"></i></button>
		<div class="sub-buttons">
		  <button class="sub-button" id="read-mode" title="Read mode"><i class="fas fa-book-open"></i></button>
		  <button class="sub-button" id="toc" title="Toggle ToC"><i class="fa-solid fa-list-ol"></i></button>
		  <button class="sub-button" id="search-algolia" title="Algolia Search"><i class="fa-solid fa-magnifying-glass"></i></button>
		  
		  
		  
		</div>
	</div>
	<button class="toc-button" id ="toc-button"><i class="fa-solid fa-xmark"></i></button>
</body>

</html>


<script>
	const mainButton = document.querySelector('.main-button');
	const iconElement = document.querySelector('.main-button i');
	const subButtons = document.querySelector('.sub-buttons');

	const readModeButton = document.getElementById('read-mode');
	const icon_readmode = document.querySelector('#read-mode i');

	const tocButton = document.getElementById('toc');
	const icon_toc = document.querySelector('#toc i');

	const tocButton1 = document.getElementById('toc-button');

	const icon_theme = document.querySelector('#theme i');

	const searchButton = document.getElementById('search-algolia');
	const icon_search = document.querySelector('#search-algolia i');
	const algolia = document.querySelector('.aa-input-container');
	
	const asideElement = document.querySelector("aside.sidebar");
	
	const isSidebarVisible = localStorage.getItem('isSidebarVisible') !== 'false';
	
	function setSidebarLocalStorage(state) {
  		localStorage.setItem("isSidebarVisible", state);
	}

	
	const isTOCStatus = localStorage.getItem('isTOCStatus') !== 'false';
	
	function setTOCLocalStorage(state) {
  		localStorage.setItem("isTOCStatus", state);
	}

	mainButton.addEventListener('click', () => {
	  if (subButtons.style.display === 'block') {
		  iconElement.classList.replace('fa-xmark', 'fa-bars');
		  subButtons.style.display = 'none';
	  } else {
		  iconElement.classList.replace('fa-bars', 'fa-xmark');
		  subButtons.style.display = 'block';
	  }
	});

	readModeButton.addEventListener('click', () => {
	  if (icon_readmode.classList.contains('fa-book-open')) {
		showTOCButton();
			setSidebarLocalStorage(false); 
			setTOCLocalStorage(false);
			asideElement.style.display = 'none';
		  icon_readmode.classList.replace('fa-book-open', 'fa-angle-left');
		  setTimeout(function() {
			
            document.querySelector(".primary").style = "flex: 1 0 100%;";
			
        }, 100);
			document.querySelector(".post__toc.toc").className = "toc-side";
			tocButton1.style.display='block';
	  } else {
			setSidebarLocalStorage(true); 
			setTOCLocalStorage(true);
			asideElement.style.display = 'block';
		  icon_readmode.classList.replace('fa-angle-left', 'fa-book-open');
		  setTimeout(function() {
            document.querySelector(".primary").style = "flex: 0 0 65.83%;";
        }, 100);
			document.querySelector(".toc-side").className = "post__toc toc";
			tocButton1.style.display='none';

	  }
	});
	tocButton.addEventListener('click', () => {
	  if (icon_toc.classList.contains('fa-list-ol')) {
		  icon_toc.classList.replace('fa-list-ol', 'fa-xmark');
		  document.querySelector(".post__toc.toc").className = "toc-side";
		  tocButton1.style.display='block';
		  setTOCLocalStorage(false);
	  } else {
		  icon_toc.classList.replace('fa-xmark', 'fa-list-ol');
		  document.querySelector(".toc-side").className = "post__toc toc";
		  tocButton1.style.display='none';
		  setTOCLocalStorage(true);
	  }
	});
	tocButton1.addEventListener('click', () => {
		  icon_toc.classList.replace('fa-xmark', 'fa-list-ol');
		  document.querySelector(".toc-side").className = "post__toc toc";
		  tocButton1.style.display='none';
		  setTOCLocalStorage(true);
	});

	
	
	
	
	
	
	


	searchButton.addEventListener('click', () => {
		if (icon_search.classList.contains('fa-magnifying-glass')) {
			algolia.style.display = 'block';
			icon_search.classList.replace('fa-magnifying-glass', 'fa-xmark');
	  } else {
		algolia.style.display = 'none';
		icon_search.classList.replace('fa-xmark', 'fa-magnifying-glass');
	  }
	});
  </script>
<script>
	document.addEventListener('DOMContentLoaded', function() {
  const isSidebarVisible = localStorage.getItem('isSidebarVisible') !== 'false';
  const isTOCStatus = localStorage.getItem('isTOCStatus') !== 'false';
  const asideElement = document.querySelector("aside.sidebar");
  if (isSidebarVisible) {
    asideElement.style.display = 'block';
    document.querySelector(".primary").style = "flex: 0 0 65.83%;";
    
	icon_readmode.classList.remove('fa-angle-left');
    icon_readmode.classList.add('fa-book-open');
  } else {
    asideElement.style.display = 'none';
    document.querySelector(".primary").style = "flex: 1 0 100%;";
    
	icon_readmode.classList.remove('fa-book-open');
    icon_readmode.classList.add('fa-angle-left');
  }
  if (isTOCStatus) {
    document.querySelector(".toc-side").className = "post__toc toc";
	icon_toc.classList.remove('fa-xmark');
    icon_toc.classList.add('fa-list-ol');
  } else {
    document.querySelector(".post__toc.toc").className = "toc-side";
	icon_toc.classList.remove('fa-list-ol');
    icon_toc.classList.add('fa-xmark');
  }
});
</script>
<script>
	function showTOCButton() {
	
	document.addEventListener('DOMContentLoaded', function() {
 		const tocSide = document.querySelector('.toc-side');
  		const tocSideBTN = document.getElementById('toc-button');
  	
  	if(tocSide){
		tocSideBTN.style.display='block';
	}else{
		tocSideBTN.style.display='none';
	}
});
	}
	showTOCButton();
</script>
<script src="https://sunnote.xyz/js-pkg/BackToTopButton.js"></script>
<script>addBackToTop({
		diameter: 40,
		backgroundColor: 'rgb(172, 214, 255)',
		textColor: '#fff',
		scrollDuration: 300,
		showWhenScrollTopIs: 800
	})</script>



