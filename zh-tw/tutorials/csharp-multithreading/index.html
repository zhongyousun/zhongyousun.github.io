<!DOCTYPE html>
<html class="no-js" lang="zh-tw">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>C# å¤šåŸ·è¡Œç·’ - Sun è¨˜äº‹</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="C# å¤šåŸ·è¡Œç·’ç”¨æ³•ç´€éŒ„">
		<meta property="og:title" content="C# å¤šåŸ·è¡Œç·’" />
<meta property="og:description" content="C# å¤šåŸ·è¡Œç·’ç”¨æ³•ç´€éŒ„" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://sunnote.xyz/zh-tw/tutorials/csharp-multithreading/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-19T11:49:15+08:00" />
<meta property="article:modified_time" content="2023-01-19T11:49:15+08:00" />


		<meta itemprop="name" content="C# å¤šåŸ·è¡Œç·’">
<meta itemprop="description" content="C# å¤šåŸ·è¡Œç·’ç”¨æ³•ç´€éŒ„"><meta itemprop="datePublished" content="2023-01-19T11:49:15+08:00" />
<meta itemprop="dateModified" content="2023-01-19T11:49:15+08:00" />
<meta itemprop="wordCount" content="652">
<meta itemprop="keywords" content="Csharp," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="C# å¤šåŸ·è¡Œç·’"/>
<meta name="twitter:description" content="C# å¤šåŸ·è¡Œç·’ç”¨æ³•ç´€éŒ„"/>

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MWPM4C5TJS"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-MWPM4C5TJS', { 'anonymize_ip': false });
}
</script>


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/zh-tw" title="Sun Notes" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">Sun Notes</div>
					<div class="logo__tagline">Life is tough, but so are you.</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">â˜°é¸å–®</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="https://sunnote.xyz/info/zh-tw/" >
				
				<span class="menu__text">ğŸ“ƒé—œæ–¼æˆ‘</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/zh-tw/search" >
				
				<span class="menu__text">ğŸ”ç«™å…§æŸ¥è©¢</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/zh-tw/archives" >
				
				<span class="menu__text">ğŸ—„ï¸æ–‡ç« æ­¸æª”</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/" >
				
				<span class="menu__text">ğŸŒEN</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-MWPM4C5TJS', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# å¤šåŸ·è¡Œç·’</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">Alvin</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2023-01-19T11:49:15&#43;08:00">2023-01-19</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/zh-tw/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/" rel="category">ç¨‹å¼èªè¨€</a>
	</span>
</div>
				<span id="busuanzi_container_page_pv">
					ã€€ğŸ‘â€ğŸ—¨ï¸:<span id="busuanzi_value_page_pv"></span>
					  </span>
			</div>
		</header>
		
	<figure class="post__thumbnail thumbnail">
		
		<img class="thumbnail__image" src="https://sunnote.xyz/image/funny/BOU9Hs7h.jpg" alt="C# å¤šåŸ·è¡Œç·’">
		
	</figure>
<div class="post__toc toc">
	<div class="toc__title">ç›®éŒ„</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#åŸç†">åŸç†</a></li>
        <li><a href="#ç”¨é€”">ç”¨é€”</a></li>
        <li><a href="#å­¸ç¿’å‹•æ©Ÿ">å­¸ç¿’å‹•æ©Ÿ</a></li>
        <li><a href="#ç¯„ä¾‹">ç¯„ä¾‹</a></li>
        <li><a href="#éåŒæ­¥æ–¹æ³•">éåŒæ­¥æ–¹æ³•</a></li>
        <li><a href="#åŸ·è¡ŒåŸ·è¡Œç·’æ™‚å¸¶å…¥åƒæ•¸">åŸ·è¡ŒåŸ·è¡Œç·’æ™‚å¸¶å…¥åƒæ•¸</a></li>
      </ul>
    </li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p>C# å¤šåŸ·è¡Œç·’ç”¨æ³•ç´€éŒ„</p>
<p>ç›®å‰é‡åˆ°çš„å°ˆæ¡ˆéƒ½æ²’æœ‰ç¡¬æ€§éœ€æ±‚ä½¿ç”¨åˆ°å¤šåŸ·è¡Œç·’ï¼Œæ­¤ç¯‡ç‚ºç´€éŒ„è‡ªå­¸çš„éç¨‹ã€‚</p>
<h3 id="åŸç†">åŸç†</h3>
<p>å¾—å…ˆäº†è§£Program(ç¨‹å¼)/Process(ç¨‹åº)/Thread(åŸ·è¡Œç·’)çš„å·®ç•°ã€‚</p>
<ol>
<li><strong>Program(ç¨‹å¼)</strong> : é‚„å°šæœªè¼‰å…¥è¨˜æ†¶é«”çš„ç¨‹å¼ä»£ç¢¼ã€‚</li>
<li><strong>Process(ç¨‹åº)</strong> : å·²ç¶“åŸ·è¡Œä¸¦ä¸”è¼‰å…¥åˆ°è¨˜æ†¶é«”ä¸­çš„ Program ï¼Œç¨‹åºä¸­çš„æ¯ä¸€è¡Œç¨‹å¼ç¢¼éš¨æ™‚éƒ½æœ‰å¯èƒ½è¢«CPUåŸ·è¡Œã€‚</li>
<li><strong>Thread(åŸ·è¡Œç·’)</strong> : åŒä¸€å€‹ Process ä¸­æœƒæœ‰å¾ˆå¤šå€‹ Thread ï¼Œæ¯ä¸€å€‹ Thread è² è²¬æŸä¸€é …åŠŸèƒ½ã€‚</li>
</ol>
<p>ä»¥ä¾‹å­ä¾†èˆ‰ä¾‹:</p>
<p><strong>Program(ç¨‹å¼)</strong> = å·¥å» çš„è©³ç´°è£½é€ åœ–èˆ‡äººå“¡é…ç½®<br>
<strong>Process(ç¨‹åº)</strong> = å·²ç¶“åœ¨é‹è¡Œçš„å·¥å» <br>
<strong>Thread(åŸ·è¡Œç·’)</strong> = å·¥å» è£¡çš„æ¯ä½å·¥ä½œäººå“¡</p>
<p>æ™®éç¨‹å¼åŸ·è¡Œæ™‚éƒ½æ˜¯ç…§è‘—é †åºä¸€è¡Œä¸€è¡ŒåŸ·è¡Œï¼Œç›¸ä¼¼æ–¼å·¥å» è£¡çš„å·¥äººç…§è‘—é †åºå®Œæˆè‡ªå·±çš„ä»»å‹™ã€‚é€™å°±æœƒç”¢ç”Ÿç¨‹å¼åŸ·è¡Œéä¹…ï¼Œå·¥äººé‹ç”¨æ•ˆç‡ä¸é«˜çš„å•é¡Œï¼Œå¦‚æœå·¥äººå€‘å¯ä»¥åŒæ™‚åŸ·è¡Œå„è‡ªçš„ä»»å‹™(å¤šåŸ·è¡Œç·’)ï¼Œé€™æ¨£æ•ˆç‡å°±æœƒè®Šå¿«å¾ˆå¤šï¼Œä½†ç¼ºé»å°±æ˜¯ç¡¬é«”ä¸è¶³æ™‚(å·¥å» ç©ºé–“å¤ªå°)ï¼Œå¤ªå¤šå·¥äººä¸€èµ·åŸ·è¡Œä»»å‹™å°±æœƒäº’æ¶è³‡æºå°è‡´ç¨‹å¼<strong>æ­»çµ(Deadlock)</strong>ã€‚</p>
<h3 id="ç”¨é€”">ç”¨é€”</h3>
<p>ä½¿ç”¨å¤šåŸ·è¡Œç·’çš„æƒ…æ³é€šå¸¸åŒ…æ‹¬ï¼š</p>
<ol>
<li>éœ€è¦åŒæ™‚åŸ·è¡Œå¤šå€‹ä»»å‹™ï¼Œè€Œé€™äº›ä»»å‹™ä¹‹é–“æ²’æœ‰é—œè¯ã€‚ä¾‹å¦‚ï¼ŒåŒæ™‚ä¸‹è¼‰å¤šå€‹æ–‡ä»¶æˆ–è¨ˆç®—å¤šå€‹å€¼ã€‚</li>
<li>éœ€è¦ç­‰å¾…ä¸€å€‹é•·æ™‚é–“é‹è¡Œçš„ä»»å‹™ï¼Œä½†ä¸æƒ³è®“ç•Œé¢è®Šå¾—ä¸å¯äº’å‹•ã€‚ä¾‹å¦‚ï¼Œåœ¨åŒæ™‚é‹è¡Œçš„å¦ä¸€å€‹åŸ·è¡Œç·šä¸­åŸ·è¡Œè³‡æ–™åº«æŸ¥è©¢ã€‚</li>
<li>éœ€è¦åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œä½†ä¸æƒ³å› ç‚ºå®ƒé˜»å¡å…¶ä»–ä»»å‹™ã€‚ä¾‹å¦‚ï¼Œåœ¨åŒæ™‚é‹è¡Œçš„å¦ä¸€å€‹åŸ·è¡Œç·šä¸­åŸ·è¡Œç¶²è·¯é€£æ¥ã€‚</li>
<li>éœ€è¦åœ¨å¤šå€‹æ ¸å¿ƒä¸ŠåŸ·è¡Œä»»å‹™ï¼Œä»¥åˆ©ç”¨å¤šæ ¸ CPU çš„æ€§èƒ½ã€‚</li>
</ol>
<h3 id="å­¸ç¿’å‹•æ©Ÿ">å­¸ç¿’å‹•æ©Ÿ</h3>
<p>å…¬å¸å°ˆæ¡ˆæœ‰å€‹æª”æ¡ˆé å…ˆå„²å­˜çš„åŠŸèƒ½ï¼Œå› ç‚ºæ¯å¤©éƒ½æœ‰æ–°æª”æ¡ˆï¼Œéœ€è¦æ¯å¤©è·‘æ’ç¨‹åŸ·è¡Œã€‚åŸæœ¬çš„å¯«æ³•ï¼Œæ˜¯Açš„éƒ¨åˆ†ä¸‹è¼‰å®Œï¼Œå†ä¸‹è¼‰Bçš„éƒ¨åˆ†ã€‚æœƒæƒ³è©¦è©¦çœ‹æ”¹ç”¨å¤šåŸ·è¡Œç·’çš„æ–¹å¼å¯«çš„åŸå› ï¼Œä¸»è¦åªæ˜¯è¦ºå¾—åœ¨æ¸¬è©¦æ™‚è³‡æ–™é‡å¤ªå¤§ï¼Œéœ€è¦å…ˆç­‰Aè·‘å®Œæ‰èƒ½æ¸¬è©¦Bçš„éƒ¨åˆ†å¾ˆç…©è€Œå·²ã€‚ğŸ˜</p>
<h3 id="ç¯„ä¾‹">ç¯„ä¾‹</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#66d9ef">using</span> System.Threading;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>Thread thread1 = <span style="color:#66d9ef">new</span> Thread(Task1);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>thread1.Start();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>Thread thread2 = <span style="color:#66d9ef">new</span> Thread(Task2);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>thread2.Start();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>Console.WriteLine(<span style="color:#e6db74">&#34;Completed&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>Console.ReadKey();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Task1()
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">5</span>; i++)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>        Console.WriteLine(<span style="color:#e6db74">&#34;Task 1&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>        Thread.Sleep(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Task2()
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">5</span>; i++)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>    {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>        Console.WriteLine(<span style="color:#e6db74">&#34;Task 2&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>        Thread.Sleep(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>}
</span></span></code></pre></div><p>çµæœ:</p>
<pre tabindex="0"><code>Completed
Task 1
Task 2
Task 1
Task 2
Task 1
Task 2
Task 1
Task 2
Task 2
Task 1
</code></pre><p><strong>ç‚ºä»€éº¼æœƒå…ˆå‡ºç¾ &ldquo;Completed&rdquo; ?</strong><br>
é€™æ˜¯å› ç‚ºåœ¨ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­ï¼Œå…©å€‹åŸ·è¡Œç·’è¢«åŒæ™‚å•Ÿå‹•ï¼Œä¸¦ä¸”ä¸»åŸ·è¡Œç·’ä¸ç­‰å¾…å…¶ä¸­ä»»ä½•ä¸€å€‹åŸ·è¡Œç·’å®Œæˆï¼Œè€Œæ˜¯ç«‹å³å¯«å‡º &ldquo;Completed&rdquo; ä¸¦çµæŸç¨‹å¼ã€‚å› æ­¤ï¼Œç„¡è«–å“ªå€‹åŸ·è¡Œç·’å…ˆå®Œæˆï¼Œç¨‹å¼éƒ½æœƒå…ˆå¯«å‡º &ldquo;Completed&rdquo;ã€‚</p>
<p>å¦‚æœæƒ³è¦ç­‰å¾… thread2 å®Œæˆï¼Œå¯ä»¥åŠ ä¸Š thread2.Join() ä½¿ä¸»åŸ·è¡Œç·’ç­‰å¾… thread2 åŸ·è¡Œå®Œç•¢ã€‚</p>
<h3 id="éåŒæ­¥æ–¹æ³•">éåŒæ­¥æ–¹æ³•</h3>
<h3 id="åŸ·è¡ŒåŸ·è¡Œç·’æ™‚å¸¶å…¥åƒæ•¸">åŸ·è¡ŒåŸ·è¡Œç·’æ™‚å¸¶å…¥åƒæ•¸</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1</span><span><span style="color:#a6e22e">[Route(&#34;api/dlcoaschedule&#34;)]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2</span><span><span style="color:#a6e22e">        [HttpPost]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3</span><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> DlCoaSchedule()
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5</span><span>            <span style="color:#75715e">///å¤–éŠ·COA é å­˜</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6</span><span>            List&lt;<span style="color:#66d9ef">dynamic</span>&gt; expnoList = DataObject.Object.SQL.coa_prevdl_file.Schedule();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7</span><span>            <span style="color:#66d9ef">if</span> (expnoList == <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8</span><span>            <span style="color:#66d9ef">byte</span>[] file;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9</span><span>            <span style="color:#66d9ef">var</span> listContainer1 = <span style="color:#66d9ef">new</span> ListContainer1 { TheList = expnoList };
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10</span><span>            <span style="color:#75715e">// å»ºç«‹æ–°çš„åŸ·è¡Œåº</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11</span><span>            Thread t1 = <span style="color:#66d9ef">new</span> Thread(<span style="color:#66d9ef">new</span> ParameterizedThreadStart(ExportCOA));
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12</span><span>            <span style="color:#75715e">// å‚³éåƒæ•¸</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13</span><span>            t1.Start(listContainer1);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14</span><span>            <span style="color:#75715e">//t1.Join();</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16</span><span>            <span style="color:#75715e">//å…§éŠ·COA é å­˜</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17</span><span>            List&lt;<span style="color:#66d9ef">string</span>&gt; codivs = <span style="color:#66d9ef">new</span> List&lt;<span style="color:#66d9ef">string</span>&gt;();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18</span><span>            codivs.Add(Codiv.PE);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19</span><span>            codivs.Add(Codiv.PP);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20</span><span>            List&lt;coa_prevdl_file&gt; inqtnoList = DataObject.Object.SQL.coa_prevdl_file.GetList(codivs);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21</span><span>            <span style="color:#66d9ef">if</span> (inqtnoList == <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23</span><span>            <span style="color:#66d9ef">var</span> listContainer2 = <span style="color:#66d9ef">new</span> ListContainer2 { TheList = inqtnoList };
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24</span><span>            <span style="color:#75715e">// å»ºç«‹æ–°çš„åŸ·è¡Œåº</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25</span><span>            Thread t2 = <span style="color:#66d9ef">new</span> Thread(<span style="color:#66d9ef">new</span> ParameterizedThreadStart(Domestic));
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26</span><span>            <span style="color:#75715e">// å‚³éåƒæ•¸</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27</span><span>            t2.Start(listContainer2);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28</span><span>            <span style="color:#75715e">//t2.Join();</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33</span><span>        <span style="color:#75715e">// Create an object to hold the list</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34</span><span>        <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ListContainer1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36</span><span>            <span style="color:#66d9ef">public</span> List&lt;<span style="color:#66d9ef">dynamic</span>&gt; TheList { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38</span><span>        <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ListContainer2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40</span><span>            <span style="color:#66d9ef">public</span> List&lt;coa_prevdl_file&gt; TheList { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45</span><span>        <span style="color:#66d9ef">void</span> ExportCOA(Object listContainer)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47</span><span>            ListContainer1 container = (ListContainer1)listContainer;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48</span><span>            List&lt;<span style="color:#66d9ef">dynamic</span>&gt; expnoList = container.TheList;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49</span><span>            <span style="color:#66d9ef">byte</span>[] file;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50</span><span>            <span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> item <span style="color:#66d9ef">in</span> expnoList)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51</span><span>            {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52</span><span>                <span style="color:#66d9ef">string</span> expno = item.expno;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53</span><span>                <span style="color:#66d9ef">string</span> codiv = item.codiv;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54</span><span>                <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55</span><span>                {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56</span><span>                    <span style="color:#75715e">//è£½ä½œpdfæª”</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57</span><span>                    <span style="color:#66d9ef">if</span> (Codiv.PE.Equals(codiv))
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58</span><span>                    {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59</span><span>                        DataObject._8.Object.SQL.coa_data.DlCOA(codiv, expno, <span style="color:#66d9ef">out</span> file, <span style="color:#e6db74">&#34;N&#34;</span>, <span style="color:#e6db74">&#34;en&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60</span><span>                        <span style="color:#66d9ef">if</span> (file != <span style="color:#66d9ef">null</span>) DataObject.Object.SQL.coa_prevdl_file.GetCOAFileInAdvance(expno, file, <span style="color:#e6db74">&#34;en&#34;</span>, SalesArea.Export);<span style="color:#75715e">//å„²å­˜pdfæª”</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61</span><span>                        file = <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62</span><span>                        DataObject._8.Object.SQL.coa_data.DlCOA(codiv, expno, <span style="color:#66d9ef">out</span> file, <span style="color:#e6db74">&#34;N&#34;</span>, <span style="color:#e6db74">&#34;zh&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63</span><span>                        <span style="color:#66d9ef">if</span> (file != <span style="color:#66d9ef">null</span>) DataObject.Object.SQL.coa_prevdl_file.GetCOAFileInAdvance(expno, file, <span style="color:#e6db74">&#34;zh&#34;</span>, SalesArea.Export);<span style="color:#75715e">//å„²å­˜pdfæª”</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64</span><span>                    }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65</span><span>                    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (Codiv.PP.Equals(codiv.ToLower()))
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66</span><span>                    {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67</span><span>                        DataObject.P.Object.SQL.coa_data.DlCOA(codiv, expno, <span style="color:#e6db74">&#34;en&#34;</span>, <span style="color:#66d9ef">out</span> file);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68</span><span>                        <span style="color:#66d9ef">if</span> (file != <span style="color:#66d9ef">null</span>) DataObject.Object.SQL.coa_prevdl_file.GetCOAFileInAdvance(expno, file, <span style="color:#e6db74">&#34;en&#34;</span>, SalesArea.Export);<span style="color:#75715e">//å„²å­˜pdfæª”</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69</span><span>                    }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70</span><span>                    
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71</span><span>                }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72</span><span>                <span style="color:#66d9ef">catch</span> (Exception e)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73</span><span>                {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74</span><span>                    <span style="color:#66d9ef">if</span> (Convert.ToBoolean(isOfficial)) SPMTools.fpcetgAlert.pushMessage(Developer.Sun, expno + <span style="color:#e6db74">&#34; COA DL Error&#34;</span> + e);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75</span><span>                    <span style="color:#66d9ef">else</span> SPMTools.fpcetgAlert.pushMessage(Developer.Sun, <span style="color:#e6db74">&#34;(æ¸¬è©¦æ©Ÿ)&#34;</span> + expno + <span style="color:#e6db74">&#34; COA DL Error&#34;</span> + e);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76</span><span>                }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79</span><span>            <span style="color:#66d9ef">if</span> (Convert.ToBoolean(isOfficial)) SPMTools.fpcetgAlert.pushMessage(Developer.Sun, DateTime.Now.ToString() + <span style="color:#e6db74">&#34;å¤–éŠ·COAé å­˜åŸ·è¡ŒæˆåŠŸ&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80</span><span>            <span style="color:#66d9ef">else</span> SPMTools.fpcetgAlert.pushMessage(Developer.Sun, DateTime.Now.ToString() + <span style="color:#e6db74">&#34;(æ¸¬è©¦æ©Ÿ)å¤–éŠ·COAé å­˜åŸ·è¡ŒæˆåŠŸ&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81</span><span>            
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83</span><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Domestic(Object listContainer)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84</span><span>        {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85</span><span>            ListContainer2 container = (ListContainer2)listContainer;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86</span><span>            List&lt;coa_prevdl_file&gt; inqtnoList = container.TheList;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87</span><span>            <span style="color:#66d9ef">byte</span>[] file;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88</span><span>            file = <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89</span><span>            <span style="color:#66d9ef">foreach</span> (coa_prevdl_file item <span style="color:#66d9ef">in</span> inqtnoList)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90</span><span>            {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91</span><span>                <span style="color:#66d9ef">bool</span> is_finished = <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92</span><span>                <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93</span><span>                {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94</span><span>                    <span style="color:#66d9ef">if</span> (Codiv.PE.Equals(item.codiv.ToLower()))
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95</span><span>                    {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96</span><span>                        <span style="color:#66d9ef">if</span> (item.acdlqty == item.old_acdlqty) <span style="color:#66d9ef">continue</span>; <span style="color:#75715e">//å¦‚æœå‡ºè²¨é‡æ²’æ”¹è®Šå°±ä¸é‡æ–°ä¸‹è¼‰</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97</span><span>                        DataObject._8.Object.SQL.coa_data.DomesticCOADl(item.no, <span style="color:#66d9ef">out</span> file);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98</span><span>                        <span style="color:#66d9ef">if</span> (item.acdlqty &gt;= item.aoqty) is_finished = <span style="color:#66d9ef">true</span>; <span style="color:#75715e">//å·²å‡ºè²¨é‡å¤§æ–¼è¨‚è²¨é‡ï¼Œis_finished= true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99</span><span>                        <span style="color:#75715e">//å„²å­˜pdfæª”</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100</span><span>                        <span style="color:#66d9ef">if</span> (file != <span style="color:#66d9ef">null</span>) DataObject.Object.SQL.coa_prevdl_file.GetCOAFileInAdvance(item.no, file, <span style="color:#e6db74">&#34;zh&#34;</span>, SalesArea.Domestic, <span style="color:#66d9ef">null</span>, item.acdlqty, is_finished);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101</span><span>                    }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102</span><span>                    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (Codiv.PP.Equals(item.codiv.ToLower()))
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103</span><span>                    {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104</span><span>                        <span style="color:#66d9ef">if</span> (item.acdlqty == item.old_acdlqty) <span style="color:#66d9ef">continue</span>; <span style="color:#75715e">//å¦‚æœå‡ºè²¨é‡æ²’æ”¹è®Šå°±ä¸é‡æ–°ä¸‹è¼‰</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105</span><span>                        DataObject.P.Object.SQL.coa_data.DomesticCOADl(item.no, <span style="color:#66d9ef">out</span> file);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106</span><span>                        <span style="color:#66d9ef">if</span> (item.acdlqty &gt;= item.aoqty) is_finished = <span style="color:#66d9ef">true</span>; <span style="color:#75715e">//å·²å‡ºè²¨é‡å¤§æ–¼è¨‚è²¨é‡ï¼Œis_finished= true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107</span><span>                        <span style="color:#75715e">//å„²å­˜pdfæª”</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108</span><span>                        <span style="color:#66d9ef">if</span> (file != <span style="color:#66d9ef">null</span>) DataObject.Object.SQL.coa_prevdl_file.GetCOAFileInAdvance(item.no, file, <span style="color:#e6db74">&#34;zh&#34;</span>, SalesArea.Domestic, <span style="color:#66d9ef">null</span>, item.acdlqty, is_finished);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109</span><span>                    }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112</span><span>                }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113</span><span>                <span style="color:#66d9ef">catch</span> (Exception e)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114</span><span>                {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115</span><span>                    <span style="color:#66d9ef">if</span> (Convert.ToBoolean(isOfficial)) SPMTools.fpcetgAlert.pushMessage(Developer.Sun, item.no + <span style="color:#e6db74">&#34; COA DL Error&#34;</span> + e);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116</span><span>                    <span style="color:#66d9ef">else</span> SPMTools.fpcetgAlert.pushMessage(Developer.Sun, <span style="color:#e6db74">&#34;(æ¸¬è©¦æ©Ÿ)&#34;</span> + item.no + <span style="color:#e6db74">&#34; COA DL Error&#34;</span> + e);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117</span><span>                }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118</span><span>            }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120</span><span>            <span style="color:#66d9ef">if</span> (Convert.ToBoolean(isOfficial)) SPMTools.fpcetgAlert.pushMessage(Developer.Sun, DateTime.Now.ToString() + <span style="color:#e6db74">&#34;å…§éŠ·COAé å­˜åŸ·è¡ŒæˆåŠŸ&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121</span><span>            <span style="color:#66d9ef">else</span> SPMTools.fpcetgAlert.pushMessage(Developer.Sun, DateTime.Now.ToString() + <span style="color:#e6db74">&#34;(æ¸¬è©¦æ©Ÿ)å…§éŠ·COAé å­˜åŸ·è¡ŒæˆåŠŸ&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123</span><span>        }
</span></span></code></pre></div>
		</div>
		<br>
		<br>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/zh-tw/tags/csharp/" rel="tag">Csharp</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="Alvin avatar" src="/img/avatar.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">
			<a href="../../info/" target="_blank" style="text-decoration:none;color:rgb(2, 1, 1);">
			é—œæ–¼ Alvin â˜€ï¸
		    </a>
		</span>
	</div>
	<div class="authorbox__description">
		ä¸æ˜¯ä¸€å€‹å¾ˆåŠªåŠ›çš„äººï¼Œç”Ÿæ´»å°±æ˜¯åœ¨è€å»¢ä¸­é †ä¾¿è¿½æ±‚é»æˆå°±æ„Ÿã€‚
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/zh-tw/tutorials/csharp-enum/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;ä¸Šä¸€ç¯‡æ–‡ç« </span>
			<p class="pager__title">C# Enum(æšèˆ‰)</p>
		</a>
	</div>
</nav>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6706017277983363"
     crossorigin="anonymous"></script>

<section class="comments">
	
	
</section>

<div>
	<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
</div>

<script src="https://utteranc.es/client.js"
  repo="zhongyousun/messageboard"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script> 

			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://cse.google.com/cse">
		<label>
			<input class="widget-search__field" type="search" placeholder="ç«™å…§æœå°‹â€¦" value="" name="q" aria-label="ç«™å…§æœå°‹â€¦">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://sunnote.xyz">
		<input type="hidden" name="cx" value="51cfcdef3e098403d" />
	</form>
</div>

<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">ç›¸é—œé€£çµ</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="GitHub" rel="noopener noreferrer" href="https://github.com/zhongyousun" target="_blank">
				<svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0c-106.1 0-192 85.8-192 191.7 0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2 0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8 0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7 0 0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4 0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5 0 25.6-.2 46.3-.2 52.6 0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg>
				<span>GitHub</span>
			</a>
		</div>

		
	</div>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">è¿‘æœŸæ–‡ç« </h4>
	<div class="widget__content">
		<ul class="widget__list">
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/tutorials/csharp-multithreading/">C# å¤šåŸ·è¡Œç·’</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/tutorials/csharp-enum/">C# Enum(æšèˆ‰)</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/sql-merge-into-%E8%AA%9E%E6%B3%95%E7%B4%80%E9%8C%84/">SQL-merge into èªæ³•ç´€éŒ„</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/leetcodemedium-146.-lru-cache-python/">Leetcode(Medium) 146. LRU Cache (Python)</a></li>
			
			
			<li class="widget__item"><a class="widget__link" href="/zh-tw/cebu/residential_area/">å®¿éœ§éŠå­¸-æ·±å…¥å®¿éœ§ä½å®…å€</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">åˆ†é¡</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E6%B5%B7%E5%A4%96%E6%97%85%E9%81%8A/">æµ·å¤–æ—…éŠ</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">9</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E7%94%9F%E6%B4%BB%E7%B4%80%E9%8C%84/">ç”Ÿæ´»ç´€éŒ„</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">9</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/">ç¨‹å¼èªè¨€</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">4</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E7%B4%94%E7%B2%B9%E5%88%86%E4%BA%AB/">ç´”ç²¹åˆ†äº«</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">4</span>
				</li>
			<li class="widget__item">
				<a class="widget__link" href="/zh-tw/categories/%E8%8B%B1%E6%96%87%E5%AD%B8%E7%BF%92/">è‹±æ–‡å­¸ç¿’</a>&nbsp;
				<span class="widget__counter widget__counter--bubble">4</span>
				</li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">æ¨™ç±¤</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/csharp/" title="Csharp">Csharp (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/leetcode/" title="LeetCode">LeetCode (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/python/" title="Python">Python (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/sql/" title="SQL">SQL (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E5%AE%BF%E9%9C%A7/" title="å®¿éœ§">å®¿éœ§ (12)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%8B%B1%E6%96%87/" title="è‹±æ–‡">è‹±æ–‡ (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%8F%B2%E5%BE%8B%E8%B3%93/" title="è²å¾‹è³“">è²å¾‹è³“ (12)</a>
		<a class="widget-taglist__link widget__link btn" href="/zh-tw/tags/%E8%AA%9E%E8%A8%80%E5%AD%B8%E6%A0%A1/" title="èªè¨€å­¸æ ¡">èªè¨€å­¸æ ¡ (8)</a>
	</div>
</div>
</aside>


		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2023 Sun.
			<span class="footer__copyright-credits">ä½¿ç”¨ <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> æŠ€è¡“èˆ‡ <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>ä¸»é¡Œ</span>

		</div>

		<span id="busuanzi_container_site_uv">
			ğŸ—¿ : <span id="busuanzi_value_site_uv"></span>
		  </span>
	</div>
	
</footer>


<script src="/js/copy-to-clipboard.js"></script>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

<div class="scene scene--card sundarkmodep">
	<div class="card">
	  <div class="card__face card__face--front"><span class="fa fa-moon" aria-hidden="true"></div>
	  <div class="card__face card__face--back"><span class="fa fa-sun" aria-hidden="true"></div>
	</div>
</div>
    
<script type="text/javascript">
	var card = document.querySelector('.card');
	card.addEventListener( 'click', function() {
	  card.classList.toggle('is-flipped');          
  });
</script>  




<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>



<script>
	$('.sundarkmodep').click(function() {
		if ($('*').hasClass("darkmodecolor")) {
			localStorage.setItem("darkmodeStatus", "sunmode");
		} else if (!$('.main-body').hasClass("darkmodecolor")) {
			localStorage.setItem("darkmodeStatus", "darkmode");
		}
		$('*').toggleClass("darkmodecolor");
	});

	var darkmodeStatus = localStorage.getItem("darkmodeStatus");

	if (darkmodeStatus == "darkmode") {
		$('*').addClass("darkmodecolor");
	}
</script>


</body>
</html>


</script>


<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 62,
  backgroundColor: 'rgb(172, 214, 255)',
  textColor: '#fff'
})</script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>